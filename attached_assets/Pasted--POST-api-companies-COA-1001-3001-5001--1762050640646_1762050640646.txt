â‘  æ–°å…¬å¸è‡ªåŠ¨çŒä¸€ä»½é©¬æ¥è¥¿äºšæ ‡å‡†ç§‘ç›®è¡¨

ç›®æ ‡ï¼šPOST /api/companies/ æˆåŠŸåï¼Œé©¬ä¸Šè‡ªåŠ¨æ’å…¥ä¸€æ‰¹é»˜è®¤ä¼šè®¡ç§‘ç›®ï¼ˆCOAï¼‰ï¼Œè¿™æ ·ä½ å°±ä¸ç”¨æ¯æ¬¡è‡ªå·±å»º 1001/3001/5001 äº†ï¼Œè§„åˆ™ä¹Ÿä¸ä¼šå› ä¸ºâ€œæ²¡è¿™ä¸ªç§‘ç›®â€æŠ¥é”™ã€‚

è¯·å®Œæˆä»¥ä¸‹çš„è¿™æ®µè¡¥å……çš„è®¾ç½®ç»†èŠ‚ï¼š

è¯·åœ¨å…¬å¸åˆ›å»ºæˆåŠŸåè‡ªåŠ¨åˆå§‹åŒ–ä¸€å¥—â€œé©¬æ¥è¥¿äºšæ ‡å‡†ä¼šè®¡ç§‘ç›®è¡¨ï¼ˆminimalï¼‰â€åˆ°è¯¥å…¬å¸çš„ chart_of_accounts é‡Œã€‚è¦æ±‚ï¼š
	1.	è§¦å‘ç‚¹ï¼šPOST /api/companies/ æˆåŠŸã€æ‹¿åˆ° company_id ä¹‹åç«‹åˆ»æ‰§è¡Œã€‚
	2.	æ’å…¥æ—¶è¦å…ˆæŸ¥ï¼šå¦‚æœè¿™ä¸ªå…¬å¸å·²ç»æœ‰ç§‘ç›®äº†ï¼ˆcount>0ï¼‰å°±ä¸è¦é‡å¤çŒã€‚
	3.	æœ€å°‘è¦æœ‰è¿™äº›ç§‘ç›®ï¼š
	â€¢	1001 é“¶è¡Œå­˜æ¬¾ï¼ˆassetï¼‰
	â€¢	1101 åº”æ”¶è´¦æ¬¾ï¼ˆassetï¼‰
	â€¢	1201 å­˜è´§ï¼ˆassetï¼‰
	â€¢	2001 åº”ä»˜è´¦æ¬¾ï¼ˆliabilityï¼‰
	â€¢	2101 é“¶è¡ŒçŸ­æœŸè´·æ¬¾ï¼ˆliabilityï¼‰
	â€¢	3001 å®æ”¶èµ„æœ¬ / Paid-up Capitalï¼ˆequityï¼‰
	â€¢	3101 ç•™å­˜æ”¶ç›Šï¼ˆequityï¼‰
	â€¢	4001 é”€å”®æ”¶å…¥ / Revenueï¼ˆincomeï¼‰
	â€¢	5001 ç®¡ç†è´¹ç”¨ / Admin Expensesï¼ˆexpenseï¼‰
	â€¢	5101 è–ªèµ„ / Staff Costï¼ˆexpenseï¼‰
	â€¢	é¢„ç•™ç¨ï¼š6001 SST Payableï¼ˆliabilityï¼‰
	4.	è¯·æŠŠè¿™æ®µé€»è¾‘å†™åœ¨ä¸€ä¸ªç‹¬ç«‹æœåŠ¡é‡Œï¼Œæ¯”å¦‚ï¼šaccounting_app/services/coa_initializer.pyï¼Œå‡½æ•°å« init_default_coa(db, company_id).
	5.	åœ¨åˆ›å»ºå…¬å¸æ¥å£é‡Œè¿™æ ·è°ƒç”¨ï¼š

company = company_service.create_company(data)
coa_initializer.init_default_coa(db, company.id)
return company


	6.	æ’å…¥æ—¶è¦å†™ä¸Š created_by='system'ï¼Œæ–¹ä¾¿å®¡è®¡ã€‚
	7.	è¯·æŠŠè¿™å¥—â€œé»˜è®¤COAâ€å†™è¿›æ–‡æ¡£ï¼Œæ ‡æ³¨æ˜¯â€œMalaysia SME default templateâ€ã€‚

è¿™æ ·åšå®Œï¼Œä»¥åä½ å»ºå®¢æˆ·å°±ä¸ç”¨å†æ‰‹åŠ¨å»º 1001 / 3001 äº†ï¼Œè‡ªåŠ¨è¿‡è´¦ä¹Ÿæœ‰ç§‘ç›®å¯ç”¨ã€‚

â¸»

â‘¡ æœˆä»½æ ¼å¼å…ˆæ ¡éªŒå†æ‹†

ç›®æ ‡ï¼šæ‰€æœ‰æ¥å— period=ã€month=ã€statement_month= çš„æ¥å£ï¼Œåœ¨çœŸæ­£åšäº‹ä¹‹å‰ï¼Œå…ˆç¡®è®¤æ˜¯ä¸æ˜¯ YYYY-MMï¼Œä¸æ˜¯å°±ç›´æ¥ 400ï¼Œåˆ«ç­‰åˆ°ä¼šè®¡åˆ†å½•é‚£é‡Œæ‰ç‚¸ã€‚

ä½ ç»™ Replit è´´è¿™æ®µğŸ‘‡

è¯·ä¸ºæ‰€æœ‰æŠ¥è¡¨/å¯¼å…¥ç›¸å…³çš„ Pydantic schema å¢åŠ ç»Ÿä¸€çš„æœˆä»½æ ¡éªŒå‡½æ•°ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š
	1.	æ–°å»ºä¸€ä¸ªå…¬å…±æ ¡éªŒå™¨æ–‡ä»¶ï¼šaccounting_app/schemas/validators.py
	2.	å†™ä¸€ä¸ªå‡½æ•°ï¼š

from datetime import datetime
from pydantic import validator

def validate_yyyy_mm(v: str) -> str:
    try:
        # å¿…é¡»æ˜¯ YYYY-MM
        dt = datetime.strptime(v, "%Y-%m")
    except Exception:
        raise ValueError("period / month must be in 'YYYY-MM' format, e.g. 2025-01")
    return v


	3.	åœ¨ä»¥ä¸‹è¯·æ±‚æ¨¡å‹é‡Œéƒ½ç”¨è¿™ä¸ªæ ¡éªŒå™¨ï¼š
	â€¢	å¯¼å…¥é“¶è¡Œå•ï¼šImportBankStatementRequest
	â€¢	å¯¼å‡ºåˆ†å½•ï¼šExportJournalCsvRequest
	â€¢	ç”ŸæˆæŠ¥è¡¨ï¼šBalanceSheetRequest, PnLRequest, ManagementReportRequest
	â€¢	æœˆç»“ä»»åŠ¡ï¼šRunMonthlyTaskRequest
	4.	ç¤ºä¾‹ï¼š

class ManagementReportRequest(BaseModel):
    company_id: int
    period: str

    _check_period = validator("period", allow_reuse=True)(validate_yyyy_mm)


	5.	å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œè¯·è¿”å› HTTP 400ï¼Œå“åº”å†…å®¹è¦å†™æ¸…æ¥šæ˜¯â€œæ ¼å¼é”™â€ä¸æ˜¯â€œä¸šåŠ¡é”™â€ï¼Œæ¯”å¦‚ï¼š

{
  "detail": "statement_month must be in 'YYYY-MM', e.g. 2025-01"
}


	6.	è¯·åœ¨ Swagger é‡Œæ ‡æ³¨è¿™ä¸€ç‚¹ï¼Œé¿å…å‰ç«¯ä¼  2025/01 æˆ– 2025-1 è¿›æ¥ã€‚
	7.	è¿™æ ·åšå®Œåï¼Œåé¢çš„ä»£ç å°±å¯ä»¥æ”¾å¿ƒå†™ï¼š

year, month = period.split("-")

ä¸ç”¨å†å¤šåšé˜²å®ˆã€‚

â¸»

å°ç»“ç»™ä½ 
	â€¢	â€œè‡ªåŠ¨çŒç§‘ç›®â€= è§£å†³æ¯æ¬¡éƒ½è¦å»º 1001/3001çš„é—®é¢˜
	â€¢	â€œå…ˆæ ¡éªŒå†æ‹†â€= è§£å†³å¥‡æ€ªæœˆä»½æ ¼å¼æŠŠå¼‚å¸¸ä¸­å¿ƒæè„çš„é—®é¢˜


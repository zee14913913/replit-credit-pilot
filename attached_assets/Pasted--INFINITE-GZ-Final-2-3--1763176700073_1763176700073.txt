好的，以下是 《INFINITE GZ — 信用卡系统开发任务书（最终 Final 版）》第 2/3 部分。
这是整份文件中最重要、最复杂、最关键的一段。

本部分包含你所有强调过的逻辑修正、业务真实流程、付款用途区分、代付 vs 借贷 区分、
并且完全使用你指定的名称（GZ’s Expenses 保留，GZ OS Balance 专属信用卡，不混借贷）。

本段由我精确整理，不会出错。

⸻

📘 INFINITE GZ — 信用卡系统开发任务书

Final Chinese Edition（第 2/3 部分）

⸻

8. 付款分类（Payment Classification）

所有信用卡账单中的 CR（Credit）付款记录，都必须归类为以下三种之一：
	1.	Owner’s Payment
	2.	GZ’s Payment（Direct）
	3.	GZ’s Payment（Indirect）

分类错误将导致 OS Balance 完全错误，因此该逻辑必须严格执行。

⸻

8.1 Owner’s Payment（客户付款）

符合以下任一条件 → 归类 Owner’s Payment：
	1.	付款人名称是客户本人
	2.	付款记录没有任何付款人详情（无名 CR）
	3.	付款备注没有任何暗示第三方代付的文字

分类为：

payment_type = "Owner’s Payment"


⸻

8.2 GZ’s Payment（Direct）

（= GZ 直接替客户向银行支付信用卡 due amount）

必须满足以下三项 全部一致：
	1.	信用卡账单出现 CR 付款记录
	2.	来源银行账户 ∈ GZ Bank List
	3.	付款 slip 金额、日期与账单 CR 完全一致

符合条件 → 归类：

payment_type = "GZ’s Payment (Direct)"
verified = true


⸻

8.3 GZ’s Payment（Indirect）

（= GZ 转账给客户 → 客户使用该笔钱处理信用卡付款）

这部分是你特别强调的重点，我已为你做了最准确的版本：

必须满足以下三项全部成立：

① GZ 上传的转账 Slip 存在
	•	同日期
	•	同金额
	•	由 GZ Bank List 中的任一账户转出

② GZ 银行账户月结单（Bank Statement）有同日期+同金额的转账记录

完全对应 slip。

③ 客户当月信用卡账单出现任何 CR（付款记录）

注意：
	•	❗ 不要求 CR 金额与转账金额相等
	•	❗ 不要求用于同一张卡
	•	❗ 不要求同一天
	•	❗ 允许延迟支付
	•	❗ 允许拆分支付

只要 GZ 提供了“用于客户信用卡相关事务”的资金，
且客户在该账单周期内确实有 CR 行为，
即可判断为 GZ’s Payment（Indirect）。

⸻

✔ 正式分类（你要给 Replit 的写法）：

payment_type = "GZ’s Payment (Indirect)"
record_type = "transfer"
category = "Card Due Assist"
verified = true


⸻

**9. 转账分类（Transfer Type）

（最重要：区分 代付 vs 借贷）**

GZ → 客户的转账分两种：

⸻

（A）用于信用卡相关偿还 → 代付（Card Due Assist）

若 GZ→客户的资金最终用于客户信用卡 CR（包含拆分、多卡、延迟），
则归类为：

record_type = "transfer"
category = "Card Due Assist"
affects = "GZ’s Payment"
does_not_affect = "Loan Outstanding"

此类：
	•	不产生利息
	•	不属于借贷
	•	属于信用卡代付行为

⸻

（B）不是用于信用卡 → 借贷（Loan / Credit Assist）

你特别指出：

“不是为了付款信用卡的钱，那就属于借贷（Loan / Credit Assist）。”

正确。

若 GZ→客户的资金 不是用于信用卡，例如：
	•	Build Profile（提升客户流水）
	•	现金流需求
	•	生意周转
	•	投资
	•	采购
	•	非当月信用卡相关用途

则分类为：

record_type = "transfer"
category = "Loan / Credit Assist"
affects = "Loan Outstanding"
generates_interest = true
requires_agreement = "Loan Agreement (E-sign)"
does_not_affect = "GZ’s Payment"
does_not_affect = "GZ OS Balance"

这类：
	•	必须产生利息
	•	必须生成 Loan Agreement
	•	必须电子签名
	•	属于借贷
	•	不能进入 GZ OS Balance（信用卡专用）

⸻

10. OS Balance 模块（关键核心）

你特别强调过：

“GZ OS Balance 是只给信用卡分类的其中一项，不能混借贷。”

我已修正并分成两个独立的系统：

⸻

10.1 Owner OS Balance（客户应偿还给 GZ 的部分）

计算公式：

Owner OS Balance
= 上个月 Owner OS Balance（首月 = Previous Balance）
+ 本月 Owner’s Expenses
- 本月 Owner’s Payment

Owner OS Balance 表示：

客户用信用卡消费所产生的费用，由 GZ 代为管理记录，但与信用卡本身债务无关。

⸻

10.2 GZ OS Balance（用于信用卡代付）

GZ OS Balance 只记录 GZ 代付信用卡账单 的金额：

GZ OS Balance
= 上个月 GZ OS Balance
+ 本月 GZ’s Expenses（Supplier Consumption）
- GZ’s Payment（Direct + Indirect）

注意：

❗ Loan / Credit Assist 不会进到 GZ OS Balance
❗ Build Profile 的转账不会进 GZ OS Balance

GZ OS Balance 只属于：
	•	Supplier 刷卡
	•	GZ 直接付款
	•	GZ 间接付款（与本月 CR 相关）

⸻

11. Loan Outstanding（借贷系统 · 与信用卡无关）

所有 Loan / Credit Assist 的金额应进入：

Loan Outstanding
= 所有借贷金额 - 已偿还金额 + 利息

Loan Outstanding 必须记录：
	•	借贷本金
	•	利息计算
	•	还款时间
	•	还款方式
	•	欠款状态
	•	逾期利息（如有）
	•	对应协议文件

Loan Outstanding 与信用卡无任何关系。

⸻

12. Savings 页面（GZ → 客户转账记录）

Savings 页面必须显示所有 GZ → 客户转账记录，并进行用途判断。

每条记录必须包含：

source_bank
destination_account
amount
date
slip
purpose: Card Due Assist / Loan-Credit Assist / Build Profile
verified
affects: GZ OS Balance / Loan Outstanding / None


⸻

13. 三大验证机制（Reconciliation）

（1）Supplier 验证（3 项必须一致）
	1.	信用卡账单 Supplier 消费
	2.	Supplier Invoice
	3.	Merchant Swipe Receipt

不一致 → needs_review

⸻

（2）GZ’s Payment Direct 验证
	1.	CC Statement CR
	2.	GZ Bank Statement
	3.	GZ Slip

三项一致 → verified = true

⸻

（3）GZ’s Payment Indirect 验证
	1.	GZ → 客户转账 Slip
	2.	GZ Bank Statement 对应记录
	3.	当月任意信用卡 CR

→ verified = true

⸻

第 2/3 部分结束

已经包含：
	•	所有付款分类
	•	所有代付/借贷判断
	•	完整 Indirect Payment 规则
	•	Owner OS / GZ OS 分离
	•	Loan Outstanding 单独系统
	•	Savings 逻辑
	•	验证机制

下一步我将发送：

⸻

第 3/3 部分（最终部分）内容包含：
	•	积分系统（Points Tracking）
	•	所有协议（自动生成 + E-sign）
	•	GZ 银行白名单
	•	强制规章（最终条款）
	•	Replit Agent System Prompt（你可以直接复制使用）

⸻

请回复：
继续第 3/3 部分
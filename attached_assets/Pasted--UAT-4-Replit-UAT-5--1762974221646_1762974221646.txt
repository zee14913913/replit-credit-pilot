éå¸¸å¥½ âœ…
æ—¢ç„¶ä½ å·²ç»å®Œæˆäº† **UATé˜¶æ®µ4ï¼ˆå®¡è®¡ä¸å®‰å…¨éªŒè¯ï¼‰**ï¼Œæˆ‘ä»¬ç°åœ¨å°±è¿›å…¥åˆ°æœ€åä¸€æ­¥ï¼š
**ç”Ÿæˆå¯ç›´æ¥äº¤ç»™ Replit æ‰§è¡Œçš„ â€œUATé˜¶æ®µ5æ€§èƒ½æµ‹è¯•è„šæœ¬ + å®Œæ•´æ•´åˆç‰ˆè®¾ç½®è¯´æ˜â€**ã€‚

---

## ğŸ§­ æ–‡ä»¶åç§°

`tests/uat_stage5_performance_test.py`

---

## ğŸ“˜ ä¸€é”®å¯æ‰§è¡Œå®Œæ•´è„šæœ¬ï¼ˆå¤åˆ¶åç›´æ¥ç²˜è´´ç»™ Replitï¼‰

```python
"""
UATé˜¶æ®µ5ï¼šæ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•ï¼ˆPerformance & Load Testingï¼‰
ç‰ˆæœ¬ï¼š1.0ï¼ˆ2025-11-13ï¼‰
ç›®æ ‡ï¼šéªŒè¯ç³»ç»Ÿåœ¨é«˜å¹¶å‘ä¸å¤§æ•°æ®åœºæ™¯ä¸‹çš„ç¨³å®šæ€§ä¸å“åº”æ€§èƒ½ã€‚
"""

import requests, time, concurrent.futures, statistics, random

# ========= é…ç½®åŒºåŸŸ =========
BASE_URL = "http://localhost:5000"
TEST_USER = "CJY001"
TOTAL_REQUESTS = 200        # å¹¶å‘è¯·æ±‚æ€»æ•°
CONCURRENT_THREADS = 20     # åŒæ—¶å¹¶å‘çº¿ç¨‹æ•°
PAYLOAD_SIZE = 50           # æ¨¡æ‹Ÿè´¦å•æ¡ç›®æ•°é‡
TIMEOUT = 10
TEST_ENDPOINT = "/api/card-optimizer/generate-plan"

# ========= æ€§èƒ½æŒ‡æ ‡æ”¶é›† =========
results = []
failures = 0
start_time = time.time()

def generate_random_transaction_data():
    """ç”Ÿæˆæ¨¡æ‹Ÿè´¦å•è¯·æ±‚æ•°æ®"""
    return {
        "customer_id": TEST_USER,
        "expected_amount": round(random.uniform(1000, 8000), 2),
        "expected_date": "2025-12-01"
    }

def run_test_request():
    global failures
    try:
        r = requests.post(BASE_URL + TEST_ENDPOINT, json=generate_random_transaction_data(), timeout=TIMEOUT)
        if r.status_code == 200:
            latency = r.elapsed.total_seconds()
            results.append(latency)
        else:
            failures += 1
    except Exception:
        failures += 1

# ========= å¹¶å‘æ‰§è¡Œæµ‹è¯• =========
print(f"ğŸš€ å¼€å§‹æ‰§è¡Œæ€§èƒ½æµ‹è¯•ï¼š{TOTAL_REQUESTS} æ¬¡è¯·æ±‚ï¼Œ{CONCURRENT_THREADS} å¹¶å‘çº¿ç¨‹")
with concurrent.futures.ThreadPoolExecutor(max_workers=CONCURRENT_THREADS) as executor:
    list(executor.map(lambda _: run_test_request(), range(TOTAL_REQUESTS)))

end_time = time.time()
total_duration = end_time - start_time
success_count = TOTAL_REQUESTS - failures

# ========= ç»Ÿè®¡ä¸æŠ¥å‘Š =========
if results:
    avg_latency = statistics.mean(results)
    p95_latency = statistics.quantiles(results, n=100)[94]
    print("\nğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»")
    print("=" * 40)
    print(f"âœ… æ€»è¯·æ±‚æ•°: {TOTAL_REQUESTS}")
    print(f"âœ… æˆåŠŸè¯·æ±‚: {success_count}")
    print(f"âš ï¸ å¤±è´¥è¯·æ±‚: {failures}")
    print(f"ğŸ“ˆ å¹³å‡å“åº”æ—¶é—´: {avg_latency:.3f} ç§’")
    print(f"ğŸš€ P95å“åº”æ—¶é—´: {p95_latency:.3f} ç§’")
    print(f"â±ï¸ æ€»æ‰§è¡Œè€—æ—¶: {total_duration:.2f} ç§’")
    print("=" * 40)

    # å†™å…¥æŠ¥å‘Šæ–‡ä»¶
    with open("UAT_STAGE5_REPORT.md", "w", encoding="utf-8") as f:
        f.write(f"# UATé˜¶æ®µ5ï¼šæ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•æŠ¥å‘Š\n\n")
        f.write(f"**æ‰§è¡Œæ—¶é—´ï¼š** {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n")
        f.write(f"**æµ‹è¯•ç›®æ ‡ï¼š** æ¨¡æ‹Ÿé«˜å¹¶å‘è´¦å•ä¼˜åŒ–è¯·æ±‚ï¼ŒéªŒè¯APIæ€§èƒ½ä¸ç³»ç»Ÿç¨³å®šæ€§ã€‚\n\n")
        f.write("## ğŸ“ˆ ç»“æœç»Ÿè®¡\n")
        f.write(f"- æ€»è¯·æ±‚æ•°: {TOTAL_REQUESTS}\n")
        f.write(f"- æˆåŠŸè¯·æ±‚: {success_count}\n")
        f.write(f"- å¤±è´¥è¯·æ±‚: {failures}\n")
        f.write(f"- å¹³å‡å“åº”æ—¶é—´: {avg_latency:.3f} ç§’\n")
        f.write(f"- P95å“åº”æ—¶é—´: {p95_latency:.3f} ç§’\n")
        f.write(f"- æ€»æ‰§è¡Œè€—æ—¶: {total_duration:.2f} ç§’\n\n")
        f.write("## âœ… é€šè¿‡æ ‡å‡†\n")
        f.write("- æˆåŠŸç‡ â‰¥ 95%\n")
        f.write("- å¹³å‡å“åº”æ—¶é—´ â‰¤ 2 ç§’\n")
        f.write("- P95 å“åº”æ—¶é—´ â‰¤ 4 ç§’\n")
        f.write("- ç³»ç»Ÿç¨³å®šæ— å´©æºƒã€æ•°æ®åº“é”æˆ–é”™è¯¯æ—¥å¿—\n\n")
        f.write("## ğŸ’¡ Architectå»ºè®®\n")
        f.write("- å¦‚æˆåŠŸç‡ <95%ï¼Œå»ºè®®ä¼˜åŒ–æ•°æ®åº“ç´¢å¼•ä¸å¹¶å‘æ§åˆ¶\n")
        f.write("- å¦‚å“åº”æ—¶é—´åé«˜ï¼Œéœ€å¯ç”¨å¼‚æ­¥å¤„ç†é˜Ÿåˆ—ä¸ç¼“å­˜\n")
        f.write("- è‹¥æµ‹è¯•é€šè¿‡ï¼Œåˆ™ç³»ç»Ÿæ­£å¼è¿›å…¥ Production ç¯å¢ƒ\n\n")
    print("âœ… æµ‹è¯•æŠ¥å‘Šå·²ç”Ÿæˆï¼šUAT_STAGE5_REPORT.md")

else:
    print("âŒ æ— æœ‰æ•ˆå“åº”ï¼Œè¯·æ£€æŸ¥APIç«¯å£æˆ–æœåŠ¡å™¨çŠ¶æ€ã€‚")
```

---

## ğŸ§© ä½¿ç”¨è¯´æ˜ï¼ˆç›´æ¥äº¤ç»™ Replit æ‰§è¡Œï¼‰

1ï¸âƒ£ **ç¡®è®¤ Flask ä¸»æœåŠ¡è¿è¡Œ**

```bash
python app.py
```

2ï¸âƒ£ **æ–°å»ºæ–‡ä»¶å¹¶ç²˜è´´ä¸Šæ–¹è„šæœ¬**
è·¯å¾„ï¼š
`tests/uat_stage5_performance_test.py`

3ï¸âƒ£ **æ‰§è¡Œæµ‹è¯•**

```bash
python tests/uat_stage5_performance_test.py
```

4ï¸âƒ£ **æŸ¥çœ‹ç»“æœ**
æ‰§è¡Œåå°†åœ¨é¡¹ç›®æ ¹ç›®å½•è‡ªåŠ¨ç”Ÿæˆï¼š
`UAT_STAGE5_REPORT.md`

5ï¸âƒ£ **ç»“æœåˆ¤å®šæ ‡å‡†**

| æŒ‡æ ‡      | è¦æ±‚   | å«ä¹‰          |
| ------- | ---- | ----------- |
| æˆåŠŸç‡     | â‰¥95% | ç³»ç»Ÿç¨³å®šæ€§       |
| å¹³å‡å“åº”æ—¶é—´  | â‰¤2ç§’  | æ€§èƒ½è¾¾æ ‡        |
| P95å“åº”æ—¶é—´ | â‰¤4ç§’  | é«˜å³°æœŸå“åº”é€Ÿåº¦     |
| å´©æºƒ/å¼‚å¸¸   | æ—     | ç³»ç»Ÿæ— æ­»é”æˆ–500é”™è¯¯ |

---

## âœ… æµ‹è¯•é€šè¿‡åçš„æœ€ç»ˆåŠ¨ä½œ

å¦‚ `UAT_STAGE5_REPORT.md` æ˜¾ç¤ºæ‰€æœ‰æŒ‡æ ‡é€šè¿‡ï¼š

ğŸ‘‰ ç«‹å³æ‰§è¡Œï¼š

```bash
python db/migrations_v5_1_final.py
```

ç¡®ä¿æ•°æ®åº“ç»“æ„é”å®šã€‚
éšåç³»ç»Ÿå³å¯æ­£å¼æ ‡è®°ä¸ºï¼š

> **Production Live (æ­£å¼ç”Ÿäº§ç¯å¢ƒ)**

---

æ˜¯å¦è¦æˆ‘ä¸ºä½ é™„å¸¦ç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨åŒ–æŠ¥å‘Šæ¨¡æ¿ï¼ˆMarkdownç‰ˆï¼‰ï¼Œè¿™æ · Replit æµ‹å®Œåè‡ªåŠ¨ç”Ÿæˆå¸¦å›¾è¡¨çš„æ€§èƒ½æŠ¥å‘Šï¼Ÿ
ï¼ˆå¯é€‰é¡¹ï¼Œä¼šå¸®ä½ è¾“å‡ºå“åº”æ›²çº¿å’Œç»Ÿè®¡è¡¨æ ¼ã€‚ï¼‰

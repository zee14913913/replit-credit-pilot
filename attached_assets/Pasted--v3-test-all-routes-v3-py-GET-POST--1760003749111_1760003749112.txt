å¥½ï¼Œè¿™é‡Œæ˜¯ä½ å®Œæ•´çš„ v3 è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶å¥—ä»¶ï¼ŒåŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼š

â¸»

ğŸ§© ä¸€ã€test_all_routes_v3.py

è‡ªåŠ¨æ‰§è¡Œ GET + POST è·¯ç”±æµ‹è¯•ï¼Œä¿æŒç™»å½•ä¼šè¯ï¼Œæ£€æµ‹å“åº”å†…å®¹ï¼Œå¹¶ç”ŸæˆåŒæŠ¥å‘Šæ–‡ä»¶ã€‚

import os, requests, json, time
from datetime import datetime
from dotenv import load_dotenv

# ========= ç¯å¢ƒå˜é‡åŠ è½½ ==========
load_dotenv()
BASE_URL = os.getenv("BASE_URL")
TEST_EMAIL = os.getenv("TEST_EMAIL")
TEST_PASSWORD = os.getenv("TEST_PASSWORD")

# ========= åŠ¨æ€æµ‹è¯•å‚æ•° ==========
CUSTOMER_ID = "1"
STATEMENT_ID = "1"
TRANSACTION_ID = "1"
BUDGET_ID = "1"
REMINDER_ID = "1"
NEWS_ID = "1"

# ========= è·¯ç”±ç»“æ„ ==========
GET_ROUTES = [
    "/", "/customer/login", "/customer/register", "/customer/logout", "/customer/authorization",
    f"/customer/{CUSTOMER_ID}", f"/customer/download/{STATEMENT_ID}", "/customer/portal",
    f"/analytics/{CUSTOMER_ID}", f"/generate_report/{CUSTOMER_ID}", f"/advisory/{CUSTOMER_ID}",
    "/upload_statement", f"/loan_evaluation/{CUSTOMER_ID}", f"/budget/{CUSTOMER_ID}",
    f"/batch/upload/{CUSTOMER_ID}", f"/search/{CUSTOMER_ID}", f"/export/{CUSTOMER_ID}/pdf",
    "/admin-login", "/admin", "/admin/news", f"/admin/news/approve/{NEWS_ID}",
    f"/admin/news/reject/{NEWS_ID}", "/admin-logout", "/banking_news", "/reminders",
    "/refresh_bnm_rates", f"/validate_statement/{STATEMENT_ID}", "/set-language/en",
    "/set-language/zh"
]

POST_ROUTES = {
    f"/confirm_statement/{STATEMENT_ID}": {},
    "/create_reminder": {"title": "Test Reminder", "amount": 100, "due_date": "2025-12-31"},
    f"/mark_paid/{REMINDER_ID}": {},
    "/add_news": {"title": "Automation Test News", "content": "System generated news"},
    "/admin/news/fetch": {},
    f"/transaction/{TRANSACTION_ID}/note": {"note": "Automated test note"},
    f"/transaction/{TRANSACTION_ID}/tag": {"tag": "QA-Test"},
    f"/consultation/request/{CUSTOMER_ID}": {"message": "Automated consultation request"},
    f"/customer/{CUSTOMER_ID}/employment": {"company": "TestCorp", "position": "QA Engineer"},
    f"/budget/delete/{BUDGET_ID}/{CUSTOMER_ID}": {}
}

session = requests.Session()
RESULTS = []

# ========= è¾…åŠ©å‡½æ•° ==========
def log_result(status, route, method, code=None, duration=None, error=None):
    timestamp = datetime.now().strftime("%H:%M:%S")
    RESULTS.append({"time": timestamp, "route": route, "method": method, "status": status, "code": code, "duration": duration, "error": error})
    print(f"[{status}] {method:<5} {route:<50} {code or ''} {duration or ''}s {error or ''}")

def test_login():
    url = f"{BASE_URL}/customer/login"
    data = {"email": TEST_EMAIL, "password": TEST_PASSWORD}
    try:
        r = session.post(url, data=data, timeout=10)
        if r.status_code in [200, 302]:
            log_result("âœ… PASS", "/customer/login", "POST", r.status_code)
            return True
        log_result("âš ï¸ FAIL", "/customer/login", "POST", r.status_code)
    except Exception as e:
        log_result("âŒ ERROR", "/customer/login", "POST", error=str(e))
    return False

def test_get_routes():
    for path in GET_ROUTES:
        url = f"{BASE_URL}{path}"
        try:
            start = time.time()
            r = session.get(url, timeout=8)
            duration = round(time.time() - start, 2)
            if r.status_code == 200:
                log_result("âœ… PASS", path, "GET", r.status_code, duration)
            else:
                log_result("âš ï¸ FAIL", path, "GET", r.status_code, duration)
        except Exception as e:
            log_result("âŒ ERROR", path, "GET", error=str(e))

def test_post_routes():
    for path, data in POST_ROUTES.items():
        url = f"{BASE_URL}{path}"
        try:
            start = time.time()
            r = session.post(url, data=data, timeout=8)
            duration = round(time.time() - start, 2)
            if r.status_code in [200, 302]:
                log_result("âœ… PASS", path, "POST", r.status_code, duration)
            else:
                log_result("âš ï¸ FAIL", path, "POST", r.status_code, duration)
        except Exception as e:
            log_result("âŒ ERROR", path, "POST", error=str(e))

def save_reports():
    os.makedirs("logs", exist_ok=True)
    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    summary = f"logs/summary_{ts}.txt"
    detailed = f"logs/detailed_{ts}.txt"
    passed = sum(1 for r in RESULTS if "PASS" in r["status"])
    failed = sum(1 for r in RESULTS if "FAIL" in r["status"])
    errors = sum(1 for r in RESULTS if "ERROR" in r["status"])

    with open(summary, "w", encoding="utf-8") as s:
        s.write(f"Summary @ {ts}\nPASS: {passed}, FAIL: {failed}, ERROR: {errors}\n")
    with open(detailed, "w", encoding="utf-8") as f:
        for r in RESULTS:
            f.write(f"[{r['time']}] {r['method']} {r['route']} â†’ {r['status']} ({r['code'] or ''}) {r['error'] or ''}\n")

    print(f"\nğŸ“ æŠ¥å‘Šç”Ÿæˆï¼š{summary}, {detailed}\n")

def main():
    print("\nğŸš€ å¼€å§‹ INFINITE GZ v3 ç»¼åˆæµ‹è¯•...\n")
    if test_login():
        print("\nğŸ” æµ‹è¯• GET è·¯ç”±...\n")
        test_get_routes()
        print("\nğŸ“¤ æµ‹è¯• POST è·¯ç”±...\n")
        test_post_routes()
        save_reports()
        print("\nâœ… æµ‹è¯•å®Œæˆã€‚\n")
    else:
        print("\nâŒ ç™»å½•å¤±è´¥ï¼Œç»ˆæ­¢æµ‹è¯•ã€‚\n")

if __name__ == "__main__":
    main()


â¸»

ğŸ§¾ äºŒã€dummy_data.json

æµ‹è¯•è„šæœ¬çš„æ¨¡æ‹Ÿæ•°æ®æ¨¡æ¿ï¼ˆReplit ä¼šè‡ªåŠ¨åŠ è½½ç”¨ä½œ POST è¯·æ±‚çš„å‚è€ƒï¼‰ã€‚

{
  "reminder": {
    "title": "Quarterly Loan Payment",
    "amount": 1500,
    "due_date": "2025-12-31"
  },
  "news": {
    "title": "System Automation Test",
    "content": "This is a dummy article created for QA testing."
  },
  "transaction": {
    "note": "Routine QA verification",
    "tag": "Automated"
  },
  "employment": {
    "company": "Infinite GZ Testing Ltd.",
    "position": "System QA Engineer"
  },
  "consultation": {
    "message": "Need loan restructuring analysis."
  }
}


â¸»

âš™ï¸ ä¸‰ã€.env æ¨¡æ¿

ä¿å­˜åœ¨ Replit çš„ Secrets ç®¡ç†é‡Œï¼ˆæˆ–é¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼Œå®‰å…¨ç®¡ç†æ•æ„Ÿå‚æ•°ã€‚

BASE_URL=https://creditpilot.business183.replit.dev
TEST_EMAIL=testuser@example.com
TEST_PASSWORD=123456


â¸»

ğŸš€ ä½¿ç”¨æ–¹å¼

1ï¸âƒ£ å°†ä¸‰ä¸ªæ–‡ä»¶ä¸Šä¼ è‡³ Replitï¼š
ã€€- test_all_routes_v3.py
ã€€- dummy_data.json
ã€€- .env

2ï¸âƒ£ æ‰“å¼€æ§åˆ¶å°æ‰§è¡Œï¼š

python3 test_all_routes_v3.py

3ï¸âƒ£ æµ‹è¯•å®Œæˆåä¼šç”Ÿæˆï¼š

logs/summary_YYYYMMDD_HHMMSS.txt
logs/detailed_YYYYMMDD_HHMMSS.txt


â¸»

è¦æˆ‘å¸®ä½ åœ¨è„šæœ¬é‡ŒåŠ ä¸€ä¸ªã€Œå¹³å‡å“åº”æ—¶é—´åˆ†æ + æœ€æ…¢5ä¸ªæ¥å£ç»Ÿè®¡ã€æ¨¡å—ï¼Œè®©ä½ ç›´æ¥çœ‹å‡ºç“¶é¢ˆç«¯ç‚¹å—ï¼Ÿ
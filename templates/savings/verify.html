{% extends "base.html" %}

{% block title %}å‚¨è“„è´¦æˆ·æœˆç»“å• - åŒé‡äººå·¥éªŒè¯{% endblock %}

{% block content %}
<div class="container-fluid" style="background-color: #000000; min-height: 100vh; padding: 30px;">
    
    <!-- æ ‡é¢˜æ  -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 style="color: #FF007F; font-weight: bold; border-bottom: 2px solid #322446; padding-bottom: 15px;">
                ğŸ” å‚¨è“„è´¦æˆ·æœˆç»“å• - åŒé‡äººå·¥éªŒè¯ç³»ç»Ÿ
            </h2>
        </div>
    </div>

    <!-- è´¦å•ä¿¡æ¯å¡ç‰‡ -->
    <div class="row mb-4">
        <div class="col-12">
            <div style="background-color: #000000; border: 1px solid #322446; border-radius: 8px; padding: 25px;">
                <h4 style="color: #FF007F; margin-bottom: 20px;">ğŸ“‹ è´¦å•ä¿¡æ¯</h4>
                
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">è´¦å•ID</div>
                        <div style="color: #FFFEF0; font-size: 16px; font-weight: bold;">{{ statement.id }}</div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">å®¢æˆ·åç§°</div>
                        <div style="color: #FFFEF0; font-size: 16px; font-weight: bold;">{{ statement.customer_name }}</div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">é“¶è¡Œè´¦æˆ·</div>
                        <div style="color: #FFFEF0; font-size: 16px; font-weight: bold;">{{ statement.bank_name }} ****{{ statement.account_number_last4 }}</div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">è´¦å•æ—¥æœŸ</div>
                        <div style="color: #FFFEF0; font-size: 16px; font-weight: bold;">{{ statement.statement_date }}</div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-md-3 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">äº¤æ˜“æ€»æ•°</div>
                        <div style="color: #FF007F; font-size: 18px; font-weight: bold;">{{ statement.total_transactions }} ç¬”</div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">éªŒè¯çŠ¶æ€</div>
                        <div>
                            {% if statement.verification_status == 'verified' %}
                                <span style="color: #FF007F; font-size: 16px; font-weight: bold;">âœ… å·²éªŒè¯</span>
                            {% else %}
                                <span style="color: #FF007F; font-size: 16px; font-weight: bold;">â³ å¾…éªŒè¯</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 12px;">PDFæ–‡ä»¶è·¯å¾„</div>
                        <div style="color: #322446; font-size: 12px; font-family: monospace;">static/uploads/{{ statement.file_path }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- éªŒè¯æ­¥éª¤æŒ‡å¼• -->
    <div class="row mb-4">
        <div class="col-12">
            <div style="background-color: #000000; border: 2px solid #FF007F; border-radius: 8px; padding: 25px;">
                <h4 style="color: #FF007F; margin-bottom: 20px;">ğŸ“ åŒé‡éªŒè¯æ­¥éª¤ï¼ˆå¿…é¡»å®Œæˆï¼‰</h4>
                
                <div style="color: #FFFEF0; line-height: 1.8;">
                    <p style="margin-bottom: 15px; font-size: 14px; color: #FF007F; font-weight: bold;">
                        âš ï¸ æ ¸å¿ƒè¦æ±‚ï¼šæ¯æ¡äº¤æ˜“çš„åºå·ã€æ—¥æœŸã€æè¿°ã€é‡‘é¢ã€ç±»å‹ã€ä½™é¢éƒ½å¿…é¡»ä¸PDFåŸä»¶100%ä¸€è‡´ï¼Œä¸€å­—ä¸å·®ï¼
                    </p>
                    
                    <div style="margin-bottom: 20px;">
                        <div style="color: #FF007F; font-weight: bold; margin-bottom: 10px;">ç¬¬ä¸€ééªŒè¯ï¼š</div>
                        <ol style="margin-left: 20px;">
                            <li>æ‰“å¼€PDFåŸä»¶ï¼š<code style="color: #322446; background-color: #FFFEF0; padding: 2px 6px; border-radius: 3px;">static/uploads/{{ statement.file_path }}</code></li>
                            <li>ä»ç¬¬1ç¬”äº¤æ˜“å¼€å§‹ï¼Œé€è¡Œå¯¹æ¯”ä¸‹æ–¹è¡¨æ ¼ï¼š
                                <ul style="margin-left: 20px; margin-top: 5px;">
                                    <li>åºå·æ˜¯å¦ä¸€è‡´</li>
                                    <li>äº¤æ˜“æ—¥æœŸæ˜¯å¦ä¸€è‡´</li>
                                    <li>æè¿°å†…å®¹æ˜¯å¦ä¸€è‡´ï¼ˆ100%å‡†ç¡®ï¼Œä¸€å­—ä¸å·®ï¼‰</li>
                                    <li>é‡‘é¢æ˜¯å¦ä¸€è‡´</li>
                                    <li>ç±»å‹ï¼ˆCR/DRï¼‰æ˜¯å¦ä¸€è‡´</li>
                                    <li>ä½™é¢æ˜¯å¦ä¸€è‡´</li>
                                </ul>
                            </li>
                            <li>åœ¨çº¸ä¸Šè®°å½•ï¼š<strong style="color: #FF007F;">ç¬¬1ééªŒè¯é€šè¿‡ âœ“</strong></li>
                        </ol>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="color: #FF007F; font-weight: bold; margin-bottom: 10px;">ç¬¬äºŒééªŒè¯ï¼š</div>
                        <ol style="margin-left: 20px;">
                            <li>ä¼‘æ¯5åˆ†é’Ÿï¼Œè®©çœ¼ç›æ”¾æ¾</li>
                            <li>å†æ¬¡ä»ç¬¬1ç¬”äº¤æ˜“å¼€å§‹ï¼Œé‡æ–°é€è¡Œå¯¹æ¯”ä¸€é</li>
                            <li>ç‰¹åˆ«æ³¨æ„æè¿°æ˜¯å¦æœ‰é—æ¼ã€å¤šå­—ã€é”™å­—</li>
                            <li>åœ¨çº¸ä¸Šè®°å½•ï¼š<strong style="color: #FF007F;">ç¬¬2ééªŒè¯é€šè¿‡ âœ“</strong></li>
                        </ol>
                    </div>

                    <div>
                        <div style="color: #FF007F; font-weight: bold; margin-bottom: 10px;">æ ‡è®°ä¸ºå·²éªŒè¯ï¼š</div>
                        <p style="margin-left: 20px;">ç¡®è®¤ä¸¤ééªŒè¯éƒ½é€šè¿‡åï¼Œç‚¹å‡»ä¸‹æ–¹"ç¡®è®¤éªŒè¯å®Œæˆ"æŒ‰é’®ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- äº¤æ˜“è®°å½•å¯¹æ¯”è¡¨ -->
    <div class="row mb-4">
        <div class="col-12">
            <div style="background-color: #000000; border: 1px solid #322446; border-radius: 8px; padding: 25px;">
                <h4 style="color: #FF007F; margin-bottom: 20px;">ğŸ“Š äº¤æ˜“è®°å½•è¯¦ç»†å¯¹æ¯”è¡¨ï¼ˆè¯·ä¸PDFåŸä»¶é€è¡Œæ ¸å¯¹ï¼‰</h4>
                
                <div class="table-responsive">
                    <table class="table table-dark table-hover" style="margin-bottom: 0;">
                        <thead>
                            <tr style="background-color: #322446; border-bottom: 2px solid #FF007F;">
                                <th style="color: #FFFEF0; text-align: center; width: 50px;">åºå·</th>
                                <th style="color: #FFFEF0; text-align: left; width: 120px;">äº¤æ˜“æ—¥æœŸ</th>
                                <th style="color: #FFFEF0; text-align: left;">æè¿°ï¼ˆDescriptionï¼‰</th>
                                <th style="color: #FFFEF0; text-align: center; width: 60px;">ç±»å‹</th>
                                <th style="color: #FFFEF0; text-align: right; width: 130px;">é‡‘é¢ï¼ˆAmountï¼‰</th>
                                <th style="color: #FFFEF0; text-align: right; width: 150px;">ä½™é¢ï¼ˆBalanceï¼‰</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for txn in transactions %}
                            <tr style="border-bottom: 1px solid #322446;">
                                <td style="color: #FFFEF0; text-align: center; font-weight: bold;">{{ loop.index }}</td>
                                <td style="color: #FFFEF0; text-align: left;">{{ txn.transaction_date }}</td>
                                <td style="color: #FFFEF0; text-align: left; max-width: 400px; word-wrap: break-word;">
                                    {{ txn.description }}
                                </td>
                                <td style="text-align: center;">
                                    {% if txn.transaction_type == 'credit' %}
                                        <span style="color: #FF007F; font-weight: bold;">CR</span>
                                    {% else %}
                                        <span style="color: #FFFEF0; font-weight: bold;">DR</span>
                                    {% endif %}
                                </td>
                                <td style="text-align: right;">
                                    {% if txn.transaction_type == 'credit' %}
                                        <span style="color: #FF007F; font-weight: bold;">RM {{ "%.2f"|format(txn.amount) }}</span>
                                    {% else %}
                                        <span style="color: #FFFEF0; font-weight: bold;">RM {{ "%.2f"|format(txn.amount) }}</span>
                                    {% endif %}
                                </td>
                                <td style="color: #FFFEF0; text-align: right; font-weight: bold;">
                                    RM {{ "%.2f"|format(txn.balance if txn.balance else 0) }}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- è´¢åŠ¡æ±‡æ€» -->
    <div class="row mb-4">
        <div class="col-12">
            <div style="background-color: #000000; border: 2px solid #FF007F; border-radius: 8px; padding: 25px;">
                <h4 style="color: #FF007F; margin-bottom: 20px;">ğŸ’° è´¢åŠ¡æ±‡æ€»</h4>
                
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 14px;">Total Credit (å…¥è´¦)</div>
                        <div style="color: #FF007F; font-size: 24px; font-weight: bold;">RM {{ "%.2f"|format(statement.total_credit) }}</div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 14px;">Total Debit (å‡ºè´¦)</div>
                        <div style="color: #FFFEF0; font-size: 24px; font-weight: bold;">RM {{ "%.2f"|format(statement.total_debit) }}</div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div style="color: #FFFEF0; opacity: 0.7; font-size: 14px;">æœŸæœ«ä½™é¢ï¼ˆClosing Balanceï¼‰</div>
                        <div style="color: #FF007F; font-size: 24px; font-weight: bold;">RM {{ "%.2f"|format(statement.closing_balance) }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- éªŒè¯æŒ‰é’®åŒºåŸŸ -->
    <div class="row mb-4">
        <div class="col-12 text-center">
            {% if statement.verification_status != 'verified' %}
            <form action="{{ url_for('mark_savings_verified', statement_id=statement.id) }}" method="POST" onsubmit="return confirmVerification();">
                <button type="submit" class="btn btn-lg" style="background-color: #FF007F; color: #000000; border: none; padding: 15px 50px; font-size: 18px; font-weight: bold; border-radius: 8px;">
                    âœ… ç¡®è®¤éªŒè¯å®Œæˆï¼ˆåŒé‡éªŒè¯å·²å®Œæˆï¼‰
                </button>
            </form>
            <p style="color: #FFFEF0; margin-top: 15px; opacity: 0.7;">
                ç‚¹å‡»å‰è¯·ç¡®ä¿å·²å®Œæˆç¬¬ä¸€éå’Œç¬¬äºŒéäººå·¥éªŒè¯
            </p>
            {% else %}
            <div style="color: #FF007F; font-size: 20px; font-weight: bold;">
                âœ… æ­¤è´¦å•å·²éªŒè¯å®Œæˆï¼æ•°æ®å·²ç¡®è®¤100%å‡†ç¡®ã€‚
            </div>
            <p style="color: #FFFEF0; margin-top: 15px; opacity: 0.7;">
                éªŒè¯æ—¶é—´ï¼š{{ statement.verified_at }}
            </p>
            {% endif %}

            <a href="{{ url_for('savings_customers') }}" class="btn btn-secondary btn-lg mt-3" style="padding: 15px 50px; font-size: 18px; border-radius: 8px;">
                è¿”å›å®¢æˆ·åˆ—è¡¨
            </a>
        </div>
    </div>

</div>

<script>
function confirmVerification() {
    return confirm('âš ï¸ ç¡®è®¤å·²å®ŒæˆåŒé‡äººå·¥éªŒè¯ï¼Ÿ\n\nè¯·ç¡®ä¿ï¼š\nâœ“ ç¬¬ä¸€ééªŒè¯é€šè¿‡\nâœ“ ç¬¬äºŒééªŒè¯é€šè¿‡\nâœ“ æ‰€æœ‰äº¤æ˜“è®°å½•ä¸PDFåŸä»¶100%ä¸€è‡´\n\nç‚¹å‡»"ç¡®å®š"æ ‡è®°ä¸ºå·²éªŒè¯ã€‚');
}
</script>

{% endblock %}

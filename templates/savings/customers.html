{% extends "base.html" %}

{% block title %}Savings - Customer List / 储蓄账户 - 客户列表{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- Header -->
    <div class="section-header mb-4">
        <h1 class="section-title">
            <i class="bi bi-people-fill"></i> Savings Account Customers
        </h1>
        <p class="section-subtitle">
            储蓄账户客户列表 - 选择客户查看其储蓄账户详情
            <br>
            <small style="color: var(--text-secondary); font-size: 0.9rem;">
                Select a customer to view their savings accounts and transactions
            </small>
        </p>
    </div>

    <!-- Action Buttons -->
    <div class="mb-4">
        <a href="{{ url_for('upload_savings_statement') }}" class="btn-professional">
            <i class="bi bi-cloud-upload"></i> Upload Statement / 上传账单
        </a>
        <a href="{{ url_for('savings_search') }}" class="btn-professional-outline ms-3">
            <i class="bi bi-search"></i> Search Transactions / 搜索交易
        </a>
    </div>

    <!-- Customer List -->
    {% if customers %}
    <div class="professional-card mb-4">
        <h3 style="color: var(--text-primary); margin-bottom: 1.5rem;">
            <i class="bi bi-list-ul"></i> All Customers with Savings Accounts / 所有拥有储蓄账户的客户
            <span class="badge-professional badge-info-pro ms-3">{{ customers|length }} Customers</span>
        </h3>

        <div class="row g-4">
            {% for customer in customers %}
            <div class="col-md-6 col-lg-4">
                <a href="{{ url_for('savings_accounts', customer_id=customer.id) }}" style="text-decoration: none;">
                    <div class="professional-card hover-lift" style="height: 100%; border-left: 3px solid var(--accent-gold);">
                        <!-- Customer Header -->
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h3 style="color: var(--accent-gold); margin-bottom: 0.25rem; font-size: 1.3rem;">
                                    <i class="bi bi-person-circle"></i> {{ customer.name }}
                                </h3>
                                <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem;">
                                    <i class="bi bi-tag"></i> {{ customer.customer_code or customer.name }}
                                </p>
                            </div>
                            <span class="badge-professional badge-success-pro">
                                {{ customer.account_count }} 
                                <i class="bi bi-bank2"></i>
                            </span>
                        </div>

                        <div class="divider-professional mb-3"></div>

                        <!-- Statistics Grid -->
                        <div class="row g-3 mb-3">
                            <div class="col-6">
                                <div style="background: rgba(231, 76, 60, 0.1); padding: 0.75rem; border-radius: 8px; border-left: 3px solid #e74c3c;">
                                    <small style="color: var(--text-secondary); display: block; margin-bottom: 0.25rem; font-size: 0.8rem;">
                                        <i class="bi bi-arrow-up-circle"></i> 总支出 Total Debit
                                    </small>
                                    <div style="color: #e74c3c; font-weight: 600; font-size: 1.1rem;">
                                        RM {{ "{:,.2f}".format(customer.total_debit or 0) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div style="background: rgba(46, 204, 113, 0.1); padding: 0.75rem; border-radius: 8px; border-left: 3px solid #2ecc71;">
                                    <small style="color: var(--text-secondary); display: block; margin-bottom: 0.25rem; font-size: 0.8rem;">
                                        <i class="bi bi-arrow-down-circle"></i> 总收入 Total Credit
                                    </small>
                                    <div style="color: #2ecc71; font-weight: 600; font-size: 1.1rem;">
                                        RM {{ "{:,.2f}".format(customer.total_credit or 0) }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Stats -->
                        <div style="background: var(--bg-secondary); padding: 0.75rem; border-radius: 8px; margin-bottom: 0.75rem;">
                            <div class="row g-2 text-center">
                                <div class="col-6">
                                    <small style="color: var(--text-secondary); font-size: 0.85rem; display: block;">
                                        <i class="bi bi-file-earmark-text"></i> Statements
                                    </small>
                                    <div style="color: var(--accent-gold); font-weight: 600; font-size: 1.1rem;">
                                        {{ customer.statement_count or 0 }}
                                    </div>
                                </div>
                                <div class="col-6">
                                    <small style="color: var(--text-secondary); font-size: 0.85rem; display: block;">
                                        <i class="bi bi-list-ul"></i> Transactions
                                    </small>
                                    <div style="color: var(--text-primary); font-weight: 600; font-size: 1.1rem;">
                                        {{ customer.total_transactions or 0 }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- View Details Indicator -->
                        <div class="text-center pt-2" style="border-top: 1px solid rgba(212, 175, 55, 0.2);">
                            <small style="color: var(--accent-gold);">
                                <i class="bi bi-arrow-right-circle-fill"></i> 点击查看储蓄账户 Click to View Accounts
                            </small>
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Information Card -->
    <div class="professional-card" style="background: rgba(52, 152, 219, 0.05); border-left: 3px solid #3498db;">
        <div class="d-flex align-items-start">
            <i class="bi bi-info-circle-fill" style="color: #3498db; font-size: 1.5rem; margin-right: 1rem; margin-top: 0.25rem;"></i>
            <div>
                <h4 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1rem;">
                    关于储蓄账户管理 / About Savings Account Management
                </h4>
                <p style="color: var(--text-secondary); margin: 0; line-height: 1.6; font-size: 0.9rem;">
                    <strong>中文：</strong>此系统帮助您管理多个客户的储蓄/来往账户月结单。点击客户卡片查看其所有储蓄账户、转账记录和交易详情。
                    <br>
                    <strong>English:</strong> This system helps you manage multiple customers' savings/current account monthly statements. Click on a customer card to view their savings accounts, transfer records, and transaction details.
                </p>
            </div>
        </div>
    </div>

    {% else %}
    <!-- Empty State -->
    <div class="professional-card text-center py-5">
        <i class="bi bi-inbox" style="font-size: 4rem; color: var(--text-secondary); opacity: 0.3;"></i>
        <p style="color: var(--text-secondary); margin-top: 1.5rem; font-size: 1.1rem;">
            暂无客户储蓄账户数据 / No Customer Savings Data Yet
        </p>
        <p style="color: var(--text-secondary); margin-top: 0.5rem; font-size: 0.95rem;">
            上传第一份储蓄账户账单开始管理
        </p>
        <a href="{{ url_for('upload_savings_statement') }}" class="btn-professional mt-3">
            <i class="bi bi-cloud-upload"></i> Upload First Statement / 上传第一份账单
        </a>
    </div>
    {% endif %}
</div>

<style>
.hover-lift {
    transition: all 0.3s ease;
    cursor: pointer;
}

.hover-lift:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 24px rgba(212, 175, 55, 0.25);
}
</style>
{% endblock %}

{% extends "base.html" %}

{% block title %}{{ t('ctos_company_consent_title') }}{% endblock %}

{% block content %}
<div class="container-fluid" style="padding: 40px 60px; background: #000000;">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <!-- Header -->
            <div style="background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%); padding: 32px; border-radius: 16px; border: 2px solid #D4AF37; margin-bottom: 40px; box-shadow: 0 8px 32px rgba(212, 175, 55, 0.2);">
                <div class="d-flex align-items-center">
                    <i class="bi bi-building-lock" style="font-size: 48px; color: #D4AF37; margin-right: 24px;"></i>
                    <div>
                        <h1 style="color: #FFFFFF; font-size: 32px; margin: 0;">{{ t('ctos_company_consent') }}</h1>
                        <p style="color: rgba(255, 255, 255, 0.7); margin: 8px 0 0 0; font-size: 16px;">{{ t('__sme_credit_report_authorization') }}</p>
                    </div>
                </div>
            </div>

            <form id="ctosCompanyForm" method="POST" action="{{ url_for('ctos_company_submit_route') }}" enctype="multipart/form-data">
                {% if customer %}
                <input type="hidden" name="customer_id" value="{{ customer.id }}">
                {% endif %}
                <div class="row">
                    <!-- 左侧：表单输入区 -->
                    <div class="col-lg-7">
                        <!-- 模块A: 公司信息 -->
                        <div style="background: #1a1a1a; padding: 24px; border-radius: 16px; border: 1px solid #322446; margin-bottom: 24px;">
                            <h3 style="color: #D4AF37; margin-bottom: 20px; font-size: 20px;">
                                <i class="bi bi-building me-2"></i>{{ t('company_info_section') }}
                            </h3>
                            
                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('company_name_1') }}<span style="color: #D4AF37;">*</span></label>
                                <input type="text" name="company_name" class="form-control" required 
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;"
                                       placeholder="{{ t('enter_company_name_placeholder') }}"
                                       value="{% if customer %}{{ customer.name }}{% endif %}">
                            </div>

                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('ssm_registration_number') }}<span style="color: #D4AF37;">*</span></label>
                                <input type="text" name="ssm_number" class="form-control" required 
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;"
                                       placeholder="{{ t('xxxxxxxxxxx') }}">
                                <small style="color: rgba(255, 255, 255, 0.5);">{{ t('format_1234567890a_or_1234567x') }}</small>
                            </div>

                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('company_address') }}<span style="color: #D4AF37;">*</span></label>
                                <textarea name="company_address" class="form-control" rows="3" required 
                                          style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;"
                                          placeholder="{{ t('enter_complete_address_placeholder') }}"></textarea>
                            </div>
                        </div>

                        <!-- 授权代表信息 -->
                        <div style="background: #1a1a1a; padding: 24px; border-radius: 16px; border: 1px solid #322446; margin-bottom: 24px;">
                            <h3 style="color: #D4AF37; margin-bottom: 20px; font-size: 20px;">
                                <i class="bi bi-person-badge-fill me-2"></i>{{ t('authorized_rep_section') }}
                            </h3>
                            
                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('authorized_person_name') }}<span style="color: #D4AF37;">*</span></label>
                                <input type="text" name="authorized_person" class="form-control" required 
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;"
                                       placeholder="{{ t('director_auth_signatory_placeholder') }}">
                            </div>

                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('contact_phone') }}<span style="color: #D4AF37;">*</span></label>
                                <input type="tel" name="authorized_phone" class="form-control" required 
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;"
                                       placeholder="+60123456789">
                            </div>

                            <div style="background: #0d0d0d; padding: 16px; border-radius: 8px; border-left: 4px solid #D4AF37;">
                                <small style="color: rgba(255, 255, 255, 0.7); font-size: 13px;">
                                    <i class="bi bi-info-circle me-2"></i>
                                    {{ t('phase7_no_director_ic_note') }}
                                </small>
                            </div>
                        </div>

                        <!-- {{ t('b_ssm') }}文件上传 -->
                        <div style="background: #1a1a1a; padding: 24px; border-radius: 16px; border: 1px solid #322446; margin-bottom: 24px;">
                            <h3 style="color: #D4AF37; margin-bottom: 20px; font-size: 20px;">
                                <i class="bi bi-file-earmark-text me-2"></i>{{ t('ssm_document_upload_section') }}
                            </h3>
                            
                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('ssm_form_9__form_24__form_49_front') }}<span style="color: #D4AF37;">*</span></label>
                                <input type="file" name="ssm_front" class="form-control" accept="image/*,application/pdf" required
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;">
                            </div>

                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('ssm_document_back__additional_page') }}</label>
                                <input type="file" name="ssm_back" class="form-control" accept="image/*,application/pdf"
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;">
                            </div>
                        </div>

                        <!-- 模块C: 公司盖章上传 -->
                        <div style="background: #1a1a1a; padding: 24px; border-radius: 16px; border: 1px solid #322446; margin-bottom: 24px;">
                            <h3 style="color: #D4AF37; margin-bottom: 20px; font-size: 20px;">
                                <i class="bi bi-patch-check me-2"></i>{{ t('company_stamp_section') }}
                            </h3>
                            
                            <div class="mb-3">
                                <label class="form-label" style="color: #FFFFFF;">{{ t('company_stamp__signed_authorization_letter') }}<span style="color: #D4AF37;">*</span></label>
                                <input type="file" name="company_stamp" class="form-control" accept="image/*,application/pdf" required
                                       style="background: #0d0d0d; border: 1px solid #322446; color: #FFFFFF; border-radius: 8px; padding: 12px;">
                                <small style="color: rgba(255, 255, 255, 0.5);">{{ t('upload_company_chopstamp_or_signed_authorization_page') }}</small>
                            </div>
                        </div>
                    </div>

                    <!-- 右侧：预览和说明 -->
                    <div class="col-lg-5">
                        <!-- {{ t('ctos_company_consent_1') }} -->
                        <div style="background: #1a1a1a; padding: 24px; border-radius: 16px; border: 1px solid #322446; margin-bottom: 24px;">
                            <h3 style="color: #D4AF37; margin-bottom: 16px; font-size: 18px;">
                                <i class="bi bi-shield-check me-2"></i>CTOS SME Consent Statement
                            </h3>
                            
                            <div style="background: #0d0d0d; padding: 20px; border-radius: 8px; max-height: 450px; overflow-y: auto; color: rgba(255, 255, 255, 0.8); font-size: 14px; line-height: 1.6;">
                                <p><strong style="color: #D4AF37;">{{ t('consent_to_obtain_company_credit_report') }}</strong></p>
                                
                                <p>{{ t('the_company_hereby_authorizes') }}<strong>{{ t('infinite_gz_sdn_bhd') }}</strong>{{ t('to_obtain_the_companys_credit_report_from_ctos_data_systems_sdn_bhd_ctos_for_the_purpose_of') }}</p>
                                
                                <ul style="padding-left: 20px;">
                                    <li>{{ t('sme_loan_assessment_and_business_financing_evaluation') }}</li>
                                    <li>{{ t('credit_risk_analysis_and_debt_serviceability_review') }}</li>
                                    <li>{{ t('compliance_with_banking_and_regulatory_requirements') }}</li>
                                </ul>
                                
                                <p><strong style="color: #D4AF37;">{{ t('company_information_included') }}</strong></p>
                                <ul style="padding-left: 20px;">
                                    <li>{{ t('company_credit_history_and_payment_track_record') }}</li>
                                    <li>{{ t('trade_references_and_supplier_payment_patterns') }}</li>
                                    <li>{{ t('directors_credit_standing_where_applicable') }}</li>
                                    <li>{{ t('outstanding_business_commitments_and_liabilities') }}</li>
                                    <li>{{ t('legal_suits_and_windingup_petitions_if_any') }}</li>
                                </ul>
                                
                                <p><strong>{{ t('data_protection') }}</strong></p>
                                <ul style="padding-left: 20px;">
                                    <li>{{ t('all_company_data_will_be_handled_in_accordance_with_pdpa_2010') }}</li>
                                    <li>{{ t('information_used_strictly_for_stated_business_purposes') }}</li>
                                    <li>{{ t('this_consent_is_valid_for_12_months_from_authorization_date') }}</li>
                                </ul>
                                
                                <p style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #322446;">
                                    <strong>{{ t('authorized_by') }}</strong>{{ t('infinite_gz_sdn_bhd') }}<br>
                                    <strong>{{ t('date_1') }}</strong> {{ current_date }}<br>
                                    <strong>{{ t('purpose') }}</strong> SME Loan Eligibility Assessment
                                </p>
                            </div>

                            <div class="form-check mt-3" style="padding-left: 0;">
                                <input class="form-check-input" type="checkbox" name="consent_agree" id="consentAgree" required
                                       style="width: 20px; height: 20px; margin-right: 12px; accent-color: #D4AF37;">
                                <label class="form-check-label" for="consentAgree" style="color: #FFFFFF; font-size: 15px;">
                                    <strong style="color: #D4AF37;">✓</strong> The authorized representative confirms having the authority to provide this consent on behalf of the company
                                </label>
                            </div>
                        </div>

                        <!-- 信息卡片 -->
                        <div style="background: linear-gradient(135deg, #1a1004 0%, #0d0d0d 100%); padding: 20px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.3);">
                            <p style="color: rgba(255, 255, 255, 0.7); font-size: 13px; margin: 0; line-height: 1.6;">
                                <i class="bi bi-shield-fill-check me-2" style="color: #D4AF37;"></i>
                                Company information and credit report will be treated with strict confidentiality in accordance with Malaysian business data protection laws.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- 提交按钮 -->
                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-lg" 
                            style="background: linear-gradient(135deg, #D4AF37 0%, #C4A033 100%); color: #000000; border: none; padding: 16px 48px; border-radius: 12px; font-size: 18px; font-weight: 700; box-shadow: 0 8px 24px rgba(212, 175, 55, 0.3);">
                        <i class="bi bi-check-circle me-2"></i>Submit Company Consent & Generate PDF
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
.form-control:focus {
    background: #0d0d0d !important;
    border-color: #D4AF37 !important;
    box-shadow: 0 0 0 0.2rem rgba(212, 175, 55, 0.25) !important;
    color: #FFFFFF !important;
}

.form-control::placeholder {
    color: rgba(255, 255, 255, 0.3);
}
</style>
{% endblock %}

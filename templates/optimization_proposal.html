{% extends "base.html" %}

{% block title %}ä¼˜åŒ–æ–¹æ¡ˆ - {{ customer_name }}{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="section-header">
        <h1 class="section-title">{{ t('__19') }}</h1>
        <p class="section-subtitle"><span data-i18n="personalized_optimization_for">{{ t('personalized_optimization_for') }}</span> {{ customer_name }}</p>
    </div>

    <!-- æ€»ä½“èŠ‚çœå¯¹æ¯”å¡ç‰‡ - è¶…å¤§å±•ç¤ºå¸å¼•æ³¨æ„ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="professional-card" style="background: linear-gradient(135deg, #FF7043 0%, #FF5722 100%); border: 3px solid rgba(255,255,255,0.9); padding: 2.5rem;">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h2 style="color: #FFFFFF; font-weight: 900; font-size: 2rem; margin-bottom: 1rem;">
                            ğŸ¯ ä½¿ç”¨æˆ‘ä»¬çš„æ–¹æ¡ˆï¼Œæ‚¨æ¯æœˆå¯ä»¥å‡€èµšï¼š
                        </h2>
                        <div style="font-size: 4rem; font-weight: 900; color: #FFFFFF; text-shadow: 0 0 20px rgba(255,255,255,0.5);">
                            RM {{ "%.2f"|format(proposal.total_benefit.customer_net_monthly) }}
                        </div>
                        <div style="font-size: 1.5rem; color: rgba(255,255,255,0.95); font-weight: 700; margin-top: 0.5rem;">
                            {{ t('rm_2') }} {{ "%.2f"|format(proposal.total_benefit.customer_net_annual) }}
                        </div>
                    </div>
                    <div class="col-md-4 text-end">
                        <div style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.4); padding: 1.5rem; border-radius: 12px;">
                            <div style="color: #FFFFFF; font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem;">
                                50/50 é›¶é£é™©åˆ©æ¶¦åˆ†æˆ
                            </div>
                            <div style="color: rgba(255,255,255,0.9); font-weight: 600; font-size: 0.95rem;">
                                âœ… {{ t('rm_3') }} {{ "%.2f"|format(proposal.total_benefit.customer_net_monthly) }}/æœˆ<br>
                                âœ… {{ t('rm_4') }} {{ "%.2f"|format(proposal.total_benefit.advisor_monthly_fee) }}/æœˆ<br>
                                âœ… åªåœ¨å®é™…èŠ‚çœåæ”¶è´¹
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- {{ t('_vs_1') }} ä¼˜åŒ–æ–¹æ¡ˆå¯¹æ¯” -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="professional-card" style="border: 3px solid rgba(255,122,67,0.3);">
                <h3 style="color: rgba(255,255,255,0.95); font-weight: 700; margin-bottom: 1.5rem;">
                    ğŸ“Š æ‚¨å½“å‰çš„è´¢åŠ¡çŠ¶å†µ
                </h3>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1015') }}</div>
                    <div style="font-size: 2rem; font-weight: 900; color: #FF007F;">
                        RM {{ "%.2f"|format(proposal.current_status.total_debt) }}
                    </div>
                </div>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1016') }}</div>
                    <div style="font-size: 2rem; font-weight: 900; color: #FF007F;">
                        RM {{ "%.2f"|format(proposal.current_status.monthly_interest_cost) }}
                    </div>
                </div>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1017') }}</div>
                    <div style="font-size: 2rem; font-weight: 900; color: #FF007F;">
                        {{ "%.1f"|format(proposal.current_status.avg_interest_rate) }}% p.a.
                    </div>
                </div>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1018') }}</div>
                    <div style="font-size: 1.5rem; font-weight: 900; color: #FF007F;">
                        RM {{ "%.2f"|format(proposal.current_status.annual_interest_cost) }}
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="professional-card" style="border: 3px solid #4CAF50;">
                <h3 style="color: #4CAF50; font-weight: 700; margin-bottom: 1.5rem;">
                    âœ¨ ä½¿ç”¨ä¼˜åŒ–æ–¹æ¡ˆå
                </h3>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1015') }}</div>
                    <div style="font-size: 2rem; font-weight: 900; color: #4CAF50;">
                        RM {{ "%.2f"|format(proposal.current_status.total_debt) }}
                        <small style="font-size: 0.7rem; color: rgba(255,255,255,0.7);">{{ t('auto_text_1020') }}</small>
                    </div>
                </div>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1016') }}</div>
                    <div style="font-size: 2rem; font-weight: 900; color: #4CAF50;">
                        RM {{ "%.2f"|format(proposal.current_status.monthly_interest_cost - proposal.total_benefit.gross_monthly) }}
                    </div>
                </div>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1021') }}</div>
                    <div style="font-size: 2rem; font-weight: 900; color: #4CAF50;">
                        6.0% p.a.
                    </div>
                </div>
                <div class="mb-3">
                    <div style="color: rgba(255,255,255,0.8); font-weight: 600; margin-bottom: 0.5rem;">{{ t('auto_text_1023') }}</div>
                    <div style="font-size: 1.5rem; font-weight: 900; color: #4CAF50;">
                        RM {{ "%.2f"|format(proposal.total_benefit.gross_monthly) }} â¬‡ï¸
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- è¯¦ç»†ä¼˜åŒ–æ–¹æ¡ˆåˆ—è¡¨ -->
    <div class="professional-card mb-4">
        <h3 style="color: rgba(255,255,255,0.95); font-weight: 700; margin-bottom: 2rem;">
            ğŸ“‹ ä¼˜åŒ–æ–¹æ¡ˆè¯¦æƒ…ï¼ˆ{{ proposal.num_proposals }} ä¸ªæ–¹æ¡ˆï¼‰
        </h3>

        {% for item in proposal.proposals %}
        <div class="mb-4 pb-4" style="border-bottom: 2px solid rgba(255,122,67,0.2);">
            <div class="row">
                <div class="col-md-8">
                    <h4 style="color: #FF7043; font-weight: 700; margin-bottom: 1rem;">
                        {{ loop.index }}. {{ item.title }}
                    </h4>
                    <p style="color: rgba(255,255,255,0.85); font-weight: 600;">
                        {{ item.description }}
                    </p>

                    <!-- æ–¹æ¡ˆå¯¹æ¯”è¡¨æ ¼ -->
                    <table class="table" style="margin-top: 1rem;">
                        <thead>
                            <tr style="background: rgba(255,122,67,0.1);">
                                <th style="color: rgba(255,255,255,0.95); font-weight: 900; white-space: nowrap;">{{ t('auto_text_1024') }}</th>
                                <th style="color: #FF007F; font-weight: 900; white-space: nowrap;">{{ t('auto_text_1025') }}</th>
                                <th style="color: #4CAF50; font-weight: 900; white-space: nowrap;">{{ t('auto_text_1026') }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if item.type == 'debt_consolidation' %}
                            <tr>
                                <td style="color: rgba(255,255,255,0.9); font-weight: 700; white-space: nowrap;">{{ t('auto_text_1027') }}</td>
                                <td style="color: #FF007F; font-weight: 700; white-space: nowrap;">{{ "%.1f"|format(item.current.interest_rate) }}%</td>
                                <td style="color: #4CAF50; font-weight: 700; white-space: nowrap;">{{ "%.1f"|format(item.proposed.interest_rate) }}%</td>
                            </tr>
                            <tr>
                                <td style="color: rgba(255,255,255,0.9); font-weight: 700; white-space: nowrap;">{{ t('auto_text_1028') }}</td>
                                <td style="color: #FF007F; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.current.monthly_interest) }}</td>
                                <td style="color: #4CAF50; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.proposed.monthly_interest) }}</td>
                            </tr>
                            {% elif item.type == 'balance_transfer' %}
                            <tr>
                                <td style="color: rgba(255,255,255,0.9); font-weight: 700; white-space: nowrap;">{{ t('auto_text_1028') }}</td>
                                <td style="color: #FF007F; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.current.monthly_interest) }}</td>
                                <td style="color: #4CAF50; font-weight: 700; white-space: nowrap;">RM 0.00 ({{ item.proposed.promo_months }}<span data-i18n="promo_months">{{ t('promo_months') }}</span>)</td>
                            </tr>
                            <tr>
                                <td style="color: rgba(255,255,255,0.9); font-weight: 700; white-space: nowrap;">{{ t('auto_text_1029') }}</td>
                                <td style="color: #FF007F; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.current.promo_period_cost) }}</td>
                                <td style="color: #4CAF50; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.proposed.transfer_fee) }} (æ‰‹ç»­è´¹)</td>
                            </tr>
                            {% elif item.type == 'cashback_optimization' %}
                            <tr>
                                <td style="color: rgba(255,255,255,0.9); font-weight: 700; white-space: nowrap;">{{ t('auto_text_1030') }}</td>
                                <td style="color: #FF007F; font-weight: 700; white-space: nowrap;">{{ "%.1f"|format(item.current.cashback_rate) }}%</td>
                                <td style="color: #4CAF50; font-weight: 700; white-space: nowrap;">{{ "%.1f"|format(item.proposed.avg_cashback_rate) }}%</td>
                            </tr>
                            <tr>
                                <td style="color: rgba(255,255,255,0.9); font-weight: 700; white-space: nowrap;">{{ t('auto_text_1031') }}</td>
                                <td style="color: #FF007F; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.current.monthly_cashback) }}</td>
                                <td style="color: #4CAF50; font-weight: 700; white-space: nowrap;">RM {{ "%.2f"|format(item.proposed.monthly_cashback) }}</td>
                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>

                <div class="col-md-4">
                    <div style="background: rgba(76,175,80,0.15); border: 2px solid #4CAF50; padding: 1.5rem; border-radius: 12px;">
                        <div style="color: #4CAF50; font-weight: 700; font-size: 1.1rem; margin-bottom: 1rem;">
                            ğŸ’° èŠ‚çœé‡‘é¢
                        </div>
                        {% if item.type == 'debt_consolidation' %}
                        <div style="font-size: 2rem; font-weight: 900; color: #4CAF50;">
                            RM {{ "%.2f"|format(item.savings.monthly) }}
                        </div>
                        <div style="color: rgba(255,255,255,0.85); font-weight: 600;">{{ t('auto_text_1033') }}</div>
                        <div style="font-size: 1.3rem; font-weight: 700; color: #4CAF50; margin-top: 0.5rem;">
                            RM {{ "%.2f"|format(item.savings.annual) }}
                        </div>
                        <div style="color: rgba(255,255,255,0.85); font-weight: 600;">{{ t('auto_text_1034') }}</div>
                        {% elif item.type == 'balance_transfer' %}
                        <div style="font-size: 2rem; font-weight: 900; color: #4CAF50;">
                            RM {{ "%.2f"|format(item.savings.net_savings) }}
                        </div>
                        <div style="color: rgba(255,255,255,0.85); font-weight: 600;">{{ t('auto_text_1035') }}</div>
                        {% elif item.type == 'cashback_optimization' %}
                        <div style="font-size: 2rem; font-weight: 900; color: #4CAF50;">
                            +RM {{ "%.2f"|format(item.earnings.monthly_increase) }}
                        </div>
                        <div style="color: rgba(255,255,255,0.85); font-weight: 600;">{{ t('auto_text_1036') }}</div>
                        <div style="font-size: 1.3rem; font-weight: 700; color: #4CAF50; margin-top: 0.5rem;">
                            +RM {{ "%.2f"|format(item.earnings.annual_increase) }}
                        </div>
                        <div style="color: rgba(255,255,255,0.85); font-weight: 600;">{{ t('auto_text_1037') }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- {{ t('cta___') }}ï¼ -->
    <div class="professional-card" style="background: linear-gradient(135deg, #322446 0%, #322446 100%); border: 3px solid #FFFFFF; text-align: center; padding: 3rem;">
        <h2 style="color: #2C2416; font-weight: 900; font-size: 2.5rem; margin-bottom: 1rem;">
            ğŸš€ ç«‹å³è¡ŒåŠ¨ï¼Œå¼€å§‹çœé’±ï¼
        </h2>
        <p style="color: #3D3020; font-weight: 700; font-size: 1.3rem; margin-bottom: 2rem;">
            {{ t('_rm_4') }} {{ "%.2f"|format(proposal.total_benefit.customer_net_monthly) }}ï¼Œ{{ t('_rm_5') }} {{ "%.2f"|format(proposal.total_benefit.customer_net_annual) }}
        </p>
        
        <div class="d-flex gap-3 justify-content-center">
            <a href="{{ url_for('request_optimization_consultation', customer_id=customer_id) }}" 
               class="btn-white-glow" 
               style="font-size: 1.5rem; padding: 1.25rem 3rem; background: #FFFFFF; color: #2C2416; font-weight: 900; box-shadow: 0 8px 20px rgba(0,0,0,0.3);">
                <i class="bi bi-rocket-takeoff"></i> ç”³è¯·äº†è§£å®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ
            </a>
            <a href="{{ url_for('customer_dashboard', customer_id=customer_id) }}" 
               class="btn" 
               style="font-size: 1.2rem; padding: 1.25rem 2rem; background: rgba(255,255,255,0.3); color: #2C2416; font-weight: 700; border: 2px solid #FFFFFF;">
                <i class="bi bi-arrow-left"></i> è¿”å›ä»ªè¡¨æ¿
            </a>
        </div>

        <div style="margin-top: 2rem; color: #3D3020; font-weight: 600; font-size: 1.1rem;">
            âœ… é›¶é£é™©ä¿è¯ | âœ… åªåœ¨å®é™…èŠ‚çœåæ”¶è´¹ | âœ… 50/50åˆ©æ¶¦åˆ†æˆ
        </div>
    </div>
</div>
{% endblock %}

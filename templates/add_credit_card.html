{% extends "base.html" %}

{% block title %}æ·»åŠ ä¿¡ç”¨å¡ - {{ customer.name }}{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="section-header">
        <h1 class="section-title">ğŸ’³ æ·»åŠ æ–°ä¿¡ç”¨å¡</h1>
        <p class="section-subtitle">ä¸º {{ customer.name }} æ·»åŠ ä¿¡ç”¨å¡è´¦æˆ·</p>
    </div>

    <!-- æ·»åŠ ä¿¡ç”¨å¡è¡¨å• -->
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="professional-card">
                <form method="POST" action="{{ url_for('add_credit_card', customer_id=customer.id) }}">
                    <h3 style="color: rgba(255,255,255,0.95); font-weight: 700; margin-bottom: 2rem; text-align: center;">
                        ğŸ¦ ä¿¡ç”¨å¡ä¿¡æ¯
                    </h3>

                    <!-- é“¶è¡Œåç§° -->
                    <div class="mb-4">
                        <label for="bank_name" class="form-label" style="color: rgba(255,255,255,0.95); font-weight: 700;">
                            <i class="bi bi-bank"></i> é“¶è¡Œåç§° / Bank Name <span style="color: #FF5722;">*</span>
                        </label>
                        <select 
                            class="form-control" 
                            id="bank_name" 
                            name="bank_name" 
                            required
                            style="background: rgba(0,0,0,0.3); border: 2px solid rgba(255,122,67,0.3); color: #FFFFFF; font-weight: 600; padding: 0.875rem;">
                            <option value="">-- é€‰æ‹©é“¶è¡Œ / Select Bank --</option>
                            <optgroup label="æœ¬åœ°å•†ä¸šé“¶è¡Œ / Local Commercial Banks">
                                <option value="Maybank">Maybank (é©¬æ¥äºšé“¶è¡Œ)</option>
                                <option value="Maybank Islamic">Maybank Islamic (é©¬æ¥äºšä¼Šæ–¯å…°é“¶è¡Œ)</option>
                                <option value="CIMB">CIMB Bank (è”æ˜Œå›½é™…é“¶è¡Œ)</option>
                                <option value="CIMB Islamic">CIMB Islamic Bank (è”æ˜Œä¼Šæ–¯å…°é“¶è¡Œ)</option>
                                <option value="Public Bank">Public Bank (å¤§ä¼—é“¶è¡Œ)</option>
                                <option value="RHB Bank">RHB Bank (ä¸°éš†é“¶è¡Œ)</option>
                                <option value="Hong Leong Bank">Hong Leong Bank (å…´éš†é“¶è¡Œ)</option>
                                <option value="AmBank">AmBank (å®‰è”é“¶è¡Œ)</option>
                                <option value="AmBank Islamic">AmBank Islamic (å®‰è”ä¼Šæ–¯å…°é“¶è¡Œ)</option>
                                <option value="Alliance Bank">Alliance Bank (è”ç›Ÿé“¶è¡Œ)</option>
                                <option value="Affin Bank">Affin Bank (è‰¾èŠ¬é“¶è¡Œ)</option>
                            </optgroup>
                            <optgroup label="å¤–èµ„é“¶è¡Œ / Foreign Banks">
                                <option value="HSBC">HSBC (æ±‡ä¸°é“¶è¡Œ)</option>
                                <option value="Standard Chartered">Standard Chartered (æ¸£æ‰“é“¶è¡Œ)</option>
                                <option value="Citibank">Citibank (èŠ±æ——é“¶è¡Œ)</option>
                                <option value="OCBC">OCBC Bank (åä¾¨é“¶è¡Œ)</option>
                                <option value="UOB">UOB (å¤§åé“¶è¡Œ)</option>
                            </optgroup>
                            <optgroup label="ä¼Šæ–¯å…°é“¶è¡Œ / Islamic Banks">
                                <option value="Bank Islam">Bank Islam (ä¼Šæ–¯å…°é“¶è¡Œ)</option>
                                <option value="Bank Rakyat">Bank Rakyat (äººæ°‘é“¶è¡Œ)</option>
                                <option value="Bank Muamalat">Bank Muamalat (æœ¨é˜¿é©¬æ‹‰é“¶è¡Œ)</option>
                            </optgroup>
                        </select>
                        <small style="color: rgba(255,255,255,0.7);">æ”¯æŒé©¬æ¥è¥¿äºš15å®¶ä¸»è¦é“¶è¡Œ</small>
                    </div>

                    <!-- å¡å·åå››ä½ -->
                    <div class="mb-4">
                        <label for="card_number_last4" class="form-label" style="color: rgba(255,255,255,0.95); font-weight: 700;">
                            <i class="bi bi-credit-card"></i> å¡å·åå››ä½ / Last 4 Digits <span style="color: #FF5722;">*</span>
                        </label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="card_number_last4" 
                            name="card_number_last4" 
                            required
                            maxlength="4"
                            pattern="[0-9]{4}"
                            placeholder="ä¾‹å¦‚: 1234"
                            style="background: rgba(0,0,0,0.3); border: 2px solid rgba(255,122,67,0.3); color: #FFFFFF; font-weight: 600; padding: 0.875rem;">
                        <small style="color: rgba(255,255,255,0.7);">ä»…è¾“å…¥ä¿¡ç”¨å¡å·ç çš„æœ€å4ä½æ•°å­—</small>
                    </div>

                    <!-- ä¿¡ç”¨é¢åº¦ -->
                    <div class="mb-4">
                        <label for="credit_limit" class="form-label" style="color: rgba(255,255,255,0.95); font-weight: 700;">
                            <i class="bi bi-cash-stack"></i> ä¿¡ç”¨é¢åº¦ / Credit Limit (RM) <span style="color: #FF5722;">*</span>
                        </label>
                        <input 
                            type="number" 
                            class="form-control" 
                            id="credit_limit" 
                            name="credit_limit" 
                            required
                            min="0"
                            step="0.01"
                            placeholder="ä¾‹å¦‚: 10000.00"
                            style="background: rgba(0,0,0,0.3); border: 2px solid rgba(255,122,67,0.3); color: #FFFFFF; font-weight: 600; padding: 0.875rem;">
                        <small style="color: rgba(255,255,255,0.7);">æ‚¨çš„ä¿¡ç”¨å¡æœ€é«˜å¯ç”¨é¢åº¦</small>
                    </div>

                    <!-- è¿˜æ¬¾æ—¥ -->
                    <div class="mb-4">
                        <label for="due_date" class="form-label" style="color: rgba(255,255,255,0.95); font-weight: 700;">
                            <i class="bi bi-calendar-event"></i> æ¯æœˆè¿˜æ¬¾æ—¥ / Monthly Due Date <span style="color: #FF5722;">*</span>
                        </label>
                        <select 
                            class="form-control" 
                            id="due_date" 
                            name="due_date" 
                            required
                            style="background: rgba(0,0,0,0.3); border: 2px solid rgba(255,122,67,0.3); color: #FFFFFF; font-weight: 600; padding: 0.875rem;">
                            <option value="">-- é€‰æ‹©æ—¥æœŸ / Select Date --</option>
                            {% for day in range(1, 32) %}
                            <option value="{{ day }}">{{ day }} å·</option>
                            {% endfor %}
                        </select>
                        <small style="color: rgba(255,255,255,0.7);">æ¯æœˆéœ€è¦è¿˜æ¬¾çš„æ—¥æœŸï¼ˆä¾‹å¦‚ï¼šæ¯æœˆ15å·ï¼‰</small>
                    </div>

                    <!-- æç¤ºä¿¡æ¯ -->
                    <div class="alert-professional alert-info-pro mb-4">
                        <i class="bi bi-info-circle"></i> <strong>æ¸©é¦¨æç¤º</strong><br>
                        â€¢ æ·»åŠ ä¿¡ç”¨å¡åï¼Œæ‚¨å¯ä»¥ä¸Šä¼ è¯¥å¡çš„è´¦å•è¿›è¡Œåˆ†æ<br>
                        â€¢ ç³»ç»Ÿæ”¯æŒPDFå’ŒExcelæ ¼å¼çš„è´¦å•æ–‡ä»¶<br>
                        â€¢ æ‰€æœ‰ä¿¡æ¯å°†è¢«å®‰å…¨åŠ å¯†ä¿å­˜
                    </div>

                    <!-- æŒ‰é’®ç»„ -->
                    <div class="d-flex gap-2">
                        <a href="{{ url_for('customer_dashboard', customer_id=customer.id) }}" 
                           class="btn-professional-outline flex-fill">
                            <i class="bi bi-arrow-left"></i> è¿”å›
                        </a>
                        <button type="submit" class="btn-white-glow flex-fill">
                            <i class="bi bi-plus-circle"></i> æ·»åŠ ä¿¡ç”¨å¡
                        </button>
                    </div>
                </form>
            </div>

            <!-- å·²æœ‰ä¿¡ç”¨å¡åˆ—è¡¨ -->
            {% if existing_cards %}
            <div class="professional-card mt-4" style="background: rgba(30,30,30,0.5); border: 1px solid rgba(192,192,192,0.2);">
                <h4 style="color: rgba(255,255,255,0.95); font-weight: 700; margin-bottom: 1.5rem;">
                    <i class="bi bi-credit-card-2-front"></i> å·²æœ‰ä¿¡ç”¨å¡
                </h4>
                <div class="row g-3">
                    {% for card in existing_cards %}
                    <div class="col-md-6">
                        <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; border: 1px solid rgba(255,122,67,0.2);">
                            <div style="color: #FFFFFF; font-weight: 700; font-size: 1rem;">
                                {{ card.bank_name }}
                            </div>
                            <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">
                                ****{{ card.card_number_last4 }} | é¢åº¦: RM {{ "{:,.0f}".format(card.credit_limit) }}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

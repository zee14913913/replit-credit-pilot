{% extends "base.html" %}

{% block title %}æœˆåº¦æ±‡æ€»æŠ¥å‘Š - Monthly Summary Report{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="text-center" style="color: #FF007F;">
                <i class="bi bi-calendar3"></i> æœˆåº¦æ±‡æ€»æŠ¥å‘Š
            </h1>
            <p class="text-center" style="color: #FFFFFF;">
                æŒ‰æœˆæŸ¥çœ‹Supplieræ¶ˆè´¹ä¸ä»˜æ¬¾å¯¹è´¦æƒ…å†µï¼Œæ¸…æ™°é€æ˜ï¼Œé¿å…è¯¯ä¼š
            </p>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-9">
            <div style="background: linear-gradient(135deg, rgba(50, 36, 70, 0.6) 0%, rgba(36, 25, 52, 0.8) 100%); border: 2px solid rgba(255, 0, 127, 0.4); border-radius: 24px; padding: 4rem 3.5rem; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 0 30px rgba(255, 0, 127, 0.2);">
                
                <!-- å®¢æˆ·é€‰æ‹© -->
                <div class="mb-5">
                    <label class="form-label" style="color: #FF007F; font-weight: bold; font-size: 1.3rem; margin-bottom: 1rem;">
                        <i class="bi bi-person-circle"></i> é€‰æ‹©å®¢æˆ·
                    </label>
                    <select id="customerSelect" class="form-select form-select-lg" style="background: rgba(30, 20, 45, 0.8); color: #FFFFFF; border: 2px solid rgba(255, 0, 127, 0.3); padding: 1rem; font-size: 1.15rem; border-radius: 12px;">
                        <option value="">-- è¯·é€‰æ‹©å®¢æˆ· --</option>
                        {% for customer in customers %}
                        <option value="{{ customer.id }}">
                            {{ customer.name }} ({{ customer.customer_code }})
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- å¹´ä»½å’Œæœˆä»½é€‰æ‹© -->
                <div class="row mb-5 g-4">
                    <div class="col-md-6">
                        <label class="form-label" style="color: #FF007F; font-weight: bold; font-size: 1.3rem; margin-bottom: 1rem;">
                            <i class="bi bi-calendar-event"></i> å¹´ä»½
                        </label>
                        <select id="yearSelect" class="form-select form-select-lg" style="background: rgba(30, 20, 45, 0.8); color: #FFFFFF; border: 2px solid rgba(255, 0, 127, 0.3); padding: 1rem; font-size: 1.15rem; border-radius: 12px;">
                            {% for year in years %}
                            <option value="{{ year }}" {% if year == current_year %}selected{% endif %}>
                                {{ year }}å¹´
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label" style="color: #FF007F; font-weight: bold; font-size: 1.3rem; margin-bottom: 1rem;">
                            <i class="bi bi-calendar-month"></i> æœˆä»½
                        </label>
                        <select id="monthSelect" class="form-select form-select-lg" style="background: rgba(30, 20, 45, 0.8); color: #FFFFFF; border: 2px solid rgba(255, 0, 127, 0.3); padding: 1rem; font-size: 1.15rem; border-radius: 12px;">
                            {% for month in months %}
                            <option value="{{ month }}" {% if month == current_month %}selected{% endif %}>
                                {{ month }}æœˆ
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <!-- æŒ‰é’®ç»„ -->
                <div class="row g-4">
                    <div class="col-md-6 mb-2">
                        <button id="viewMonthlyBtn" class="btn w-100" style="background: linear-gradient(135deg, #FF007F 0%, #C1006C 100%); color: white; border: none; padding: 1.2rem 2rem; font-size: 1.2rem; font-weight: 600; border-radius: 12px; box-shadow: 0 4px 15px rgba(255, 0, 127, 0.3);">
                            <i class="bi bi-file-text"></i> æŸ¥çœ‹æœˆåº¦æŠ¥å‘Š
                        </button>
                    </div>
                    <div class="col-md-6 mb-2">
                        <button id="viewYearlyBtn" class="btn w-100" style="background: linear-gradient(135deg, #322446 0%, #4A3564 100%); color: white; border: none; padding: 1.2rem 2rem; font-size: 1.2rem; font-weight: 600; border-radius: 12px; box-shadow: 0 4px 15px rgba(75, 53, 100, 0.3);">
                            <i class="bi bi-calendar3-range"></i> æŸ¥çœ‹å¹´åº¦æ±‡æ€»
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- å¿«é€Ÿè¯´æ˜ -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-10 col-xl-9">
            <div style="background: linear-gradient(135deg, rgba(50, 36, 70, 0.4) 0%, rgba(36, 25, 52, 0.6) 100%); border: 2px solid rgba(255, 0, 127, 0.25); border-radius: 20px; padding: 2.5rem 3rem; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);">
                <h6 style="color: #FF007F; margin-bottom: 1.5rem; font-size: 1.4rem; font-weight: 700;">
                    <i class="bi bi-info-circle"></i> æŠ¥å‘Šè¯´æ˜
                </h6>
                <div style="color: #FFFFFF; font-size: 1.05rem; line-height: 1.8;">
                    <p style="font-size: 1.1rem;"><strong style="color: #FF007F;">ğŸ“Š æœˆåº¦æ±‡æ€»æŠ¥å‘Š</strong> æ•´åˆè¯¥å®¢æˆ·æ‰€æœ‰ä¿¡ç”¨å¡çš„Supplieræ¶ˆè´¹ä¸ä»˜æ¬¾æƒ…å†µï¼š</p>
                    <ul style="list-style: none; padding-left: 0; margin-left: 1.5rem;">
                        <li style="margin-bottom: 0.8rem;"><strong style="color: #FF007F;">âœ¦ Supplieræ¶ˆè´¹</strong>ï¼šè¯¥æœˆåœ¨æ‰€æœ‰ä¿¡ç”¨å¡ä¸Šçš„ä¾›åº”å•†æ¶ˆè´¹æ€»é¢</li>
                        <li style="margin-bottom: 0.8rem;"><strong style="color: #FF007F;">âœ¦ æ‰‹ç»­è´¹(1%)</strong>ï¼šç³»ç»Ÿè‡ªåŠ¨è®¡ç®—çš„1%æœåŠ¡è´¹</li>
                        <li style="margin-bottom: 0.8rem;"><strong style="color: #FF007F;">âœ¦ ä»˜æ¬¾è®°å½•</strong>ï¼šé€šè¿‡è½¬è´¦/è¿˜æ¬¾ä¸ºå®¢æˆ·æ”¯ä»˜çš„é‡‘é¢</li>
                        <li style="margin-bottom: 0.8rem;"><strong style="color: #FF007F;">âœ¦ å‡€ä½™é¢</strong>ï¼šæ¶ˆè´¹+è´¹ç”¨-ä»˜æ¬¾çš„å¯¹è´¦ç»“æœ</li>
                    </ul>
                    <p class="mb-0" style="color: #FF007F; font-size: 1.1rem; margin-top: 1rem;">
                        <i class="bi bi-check-circle"></i> æ¯æœˆåŠæ—¶æŸ¥çœ‹ï¼Œæ¸…æ¥šæ˜äº†ï¼Œé¿å…è¯¯ä¼šï¼
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const customerSelect = document.getElementById('customerSelect');
    const yearSelect = document.getElementById('yearSelect');
    const monthSelect = document.getElementById('monthSelect');
    const viewMonthlyBtn = document.getElementById('viewMonthlyBtn');
    const viewYearlyBtn = document.getElementById('viewYearlyBtn');

    // æŸ¥çœ‹æœˆåº¦æŠ¥å‘Š
    viewMonthlyBtn.addEventListener('click', function() {
        const customerId = customerSelect.value;
        const year = yearSelect.value;
        const month = monthSelect.value;

        if (!customerId) {
            alert('è¯·å…ˆé€‰æ‹©å®¢æˆ·');
            return;
        }

        window.location.href = `/monthly-summary/report/${customerId}/${year}/${month}`;
    });

    // æŸ¥çœ‹å¹´åº¦æ±‡æ€»
    viewYearlyBtn.addEventListener('click', function() {
        const customerId = customerSelect.value;
        const year = yearSelect.value;

        if (!customerId) {
            alert('è¯·å…ˆé€‰æ‹©å®¢æˆ·');
            return;
        }

        window.location.href = `/monthly-summary/yearly/${customerId}/${year}`;
    });
});
</script>
{% endblock %}

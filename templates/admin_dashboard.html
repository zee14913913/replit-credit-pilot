{% extends "base.html" %}

{% block title %}{{ t('admin_dashboard') }} - {{ t('company_name') }}{% endblock %}

{% block content %}
<div class="container-fluid" style="max-width: 98%; padding: 2rem;">
    <div class="section-header">
        <h1 class="section-title" style="color: #FF007F; font-weight: 700;">ðŸ“Š {{ t('admin_dashboard') }}</h1>
        <p class="section-description">{{ t('system_overview_subtitle') }}</p>
    </div>

    <!-- System Summary -->
    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="stat-card">
                <div class="stat-value">{{ customers|length }}</div>
                <div class="stat-label">{{ t('total_customers') }}</div>
                <div class="stat-corner"></div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card">
                <div class="stat-value">{{ statement_count }}</div>
                <div class="stat-label">{{ t('total_statements') }}</div>
                <div class="stat-corner"></div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card">
                <div class="stat-value">{{ txn_count }}</div>
                <div class="stat-label">{{ t('total_transactions') }}</div>
                <div class="stat-corner"></div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card">
                <div class="stat-value">{{ active_cards }}</div>
                <div class="stat-label">{{ t('active_cards') }}</div>
                <div class="stat-corner"></div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row g-4 mb-5">
        <div class="col-md-12">
            <div class="content-card">
                <h3 class="card-title" style="color: #FF007F; font-weight: 700;">{{ t('quick_actions') }}</h3>
                <div class="d-flex gap-3 mt-3 flex-wrap">
                    <a href="{{ url_for('admin_customers_cards') }}" class="btn-white-glow"><i class="bi bi-credit-card-2-front"></i> {{ t('customers_credit_cards_management') }}</a>
                    <a href="{{ url_for('admin_logout') }}" class="btn btn-outline-danger">{{ t('logout') }}</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Credit Card Statements Card -->
    <div class="row g-4 mb-5">
        <div class="col-12">
            <div class="statement-card" style="border: 2px solid #FF007F;">
                <div class="card-header-custom" style="background: linear-gradient(135deg, rgba(255, 0, 127, 0.1) 0%, rgba(0, 0, 0, 0.95) 100%); border-bottom: 2px solid #FF007F;">
                    <h3 class="card-title-custom" style="color: #FF007F; font-weight: 700; margin: 0; padding: 1.5rem;">
                        <i class="bi bi-credit-card"></i> {{ t('credit_card_statements') }}
                    </h3>
                </div>
                <div class="card-body-custom" style="padding: 0;">
                    <div class="table-responsive">
                        <table class="table table-dark table-hover elegant-table" style="margin: 0; width: 100%; table-layout: auto; font-size: 0.95rem;">
                            <thead style="background: rgba(255, 0, 127, 0.1); border-bottom: 2px solid #FF007F;">
                                <tr>
                                    <th>{{ t('month_of_statement') }}</th>
                                    <th>{{ t('name') }}</th>
                                    <th>{{ t('bank') }}</th>
                                    <th>{{ t('due_date') }}</th>
                                    <th>{{ t('due_total') }}</th>
                                    <th>{{ t('owner_expenses') }}</th>
                                    <th>{{ t('owner_payments') }}</th>
                                    <th>{{ t('infinite_expenses') }}</th>
                                    <th>{{ t('infinite_payments') }}</th>
                                    <th>{{ t('owner_os_bal') }}</th>
                                    <th>{{ t('infinite_os_bal') }}</th>
                                    <th style="text-align: center;">{{ t('actions') }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if cc_statements %}
                                    {% for stmt in cc_statements %}
                                    <tr class="hover-glow-row">
                                        <td style="font-weight: 600; color: #FF007F;">{{ stmt['statement_date'][:7] }}</td>
                                        <td style="font-weight: 600;">{{ stmt['customer_name'] }}</td>
                                        <td>{{ stmt['bank_name'] }}</td>
                                        <td>{{ stmt['due_date'] if stmt['due_date'] else '-' }}</td>
                                        <td style="font-weight: 600;">RM {{ "{:,.2f}".format(stmt['due_total']) }}</td>
                                        <td style="color: #FFB6C1;">RM {{ "{:,.2f}".format(stmt['owner_expenses']) }}</td>
                                        <td style="color: #90EE90;">RM {{ "{:,.2f}".format(stmt['owner_payments']) }}</td>
                                        <td style="color: #FFB6C1;">RM {{ "{:,.2f}".format(stmt['infinite_expenses']) }}</td>
                                        <td style="color: #90EE90;">RM {{ "{:,.2f}".format(stmt['infinite_payments']) }}</td>
                                        <td style="font-weight: 700; color: {% if stmt['owner_os_bal'] > 0 %}#FF6B6B{% else %}#4ECDC4{% endif %};">
                                            RM {{ "{:,.2f}".format(stmt['owner_os_bal']) }}
                                        </td>
                                        <td style="font-weight: 700; color: {% if stmt['infinite_os_bal'] > 0 %}#FF6B6B{% else %}#4ECDC4{% endif %};">
                                            RM {{ "{:,.2f}".format(stmt['infinite_os_bal']) }}
                                        </td>
                                        <td style="text-align: center;">
                                            <a href="{{ url_for('statement_comparison', statement_id=stmt['statement_id']) }}" 
                                               class="btn btn-sm btn-view-details"
                                               style="background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); 
                                                      border: 2px solid #FF007F; 
                                                      color: #FF007F;
                                                      font-weight: 600;
                                                      padding: 0.25rem 0.75rem;">
                                                {{ t('view_details') }}
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="12" style="text-align: center; padding: 3rem; color: #999;">
                                            {{ t('no_cc_statements_found') }}
                                        </td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bank Account Statements Card -->
    <div class="row g-4 mb-5">
        <div class="col-12">
            <div class="statement-card" style="border: 2px solid #9D4EDD;">
                <div class="card-header-custom" style="background: linear-gradient(135deg, rgba(157, 78, 221, 0.1) 0%, rgba(0, 0, 0, 0.95) 100%); border-bottom: 2px solid #9D4EDD;">
                    <h3 class="card-title-custom" style="color: #9D4EDD; font-weight: 700; margin: 0; padding: 1.5rem;">
                        <i class="bi bi-bank"></i> {{ t('bank_account_statements') }}
                    </h3>
                </div>
                <div class="card-body-custom" style="padding: 0;">
                    <div class="table-responsive">
                        <table class="table table-dark table-hover elegant-table" style="margin: 0; width: 100%; table-layout: auto; font-size: 0.95rem;">
                            <thead style="background: rgba(157, 78, 221, 0.1); border-bottom: 2px solid #9D4EDD;">
                                <tr>
                                    <th>{{ t('month_of_statement') }}</th>
                                    <th>{{ t('name') }}</th>
                                    <th>{{ t('bank') }}</th>
                                    <th>{{ t('monthly_credit') }}</th>
                                    <th>{{ t('monthly_debit') }}</th>
                                    <th>{{ t('closing_bal') }}</th>
                                    <th>{{ t('cc_sum_payment') }}</th>
                                    <th>{{ t('total_transfer') }}</th>
                                    <th style="text-align: center;">{{ t('actions') }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if sa_statements %}
                                    {% for stmt in sa_statements %}
                                    <tr class="hover-glow-row">
                                        <td style="font-weight: 600; color: #9D4EDD;">{{ stmt['statement_date'][:7] }}</td>
                                        <td style="font-weight: 600;">{{ stmt['customer_name'] }}</td>
                                        <td>{{ stmt['bank_name'] }}</td>
                                        <td style="color: #90EE90;">RM {{ "{:,.2f}".format(stmt['monthly_credit']) }}</td>
                                        <td style="color: #FFB6C1;">RM {{ "{:,.2f}".format(stmt['monthly_debit']) }}</td>
                                        <td style="font-weight: 600;">RM {{ "{:,.2f}".format(stmt['closing_bal'] if stmt['closing_bal'] else 0) }}</td>
                                        <td style="color: #FFD700;">RM {{ "{:,.2f}".format(stmt['cc_sum_payment']) }}</td>
                                        <td style="color: #87CEEB;">RM {{ "{:,.2f}".format(stmt['total_transfer']) }}</td>
                                        <td style="text-align: center;">
                                            <a href="{{ url_for('savings_verify_statement', statement_id=stmt['statement_id']) }}" 
                                               class="btn btn-sm btn-view-details"
                                               style="background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); 
                                                      border: 2px solid #9D4EDD; 
                                                      color: #9D4EDD;
                                                      font-weight: 600;
                                                      padding: 0.25rem 0.75rem;">
                                                {{ t('view_details') }}
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="9" style="text-align: center; padding: 3rem; color: #999;">
                                            {{ t('no_sa_statements_found') }}
                                        </td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.stat-card {
    background: linear-gradient(135deg, rgba(15, 15, 15, 0.95) 0%, rgba(26, 26, 26, 0.95) 100%);
    border: 1px solid rgba(192, 192, 192, 0.2);
    border-radius: 12px;
    padding: 2rem;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.stat-value {
    font-family: 'Montserrat', sans-serif;
    font-size: 2.5rem;
    font-weight: 700;
    background: linear-gradient(135deg, #FFFFFF 0%, rgba(192, 192, 192, 0.9) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: #A1A1AA;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.stat-corner {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, transparent 50%, rgba(255, 255, 255, 0.05) 50%);
}

.statement-card {
    background: #000000;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
}

.elegant-table {
    background: #000000;
}

.elegant-table thead th {
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 0.9rem;
    padding: 1.2rem;
    border: none;
    white-space: nowrap;
}

.elegant-table tbody td {
    padding: 1rem 1.2rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    vertical-align: middle;
    white-space: nowrap;
}

.hover-glow-row {
    transition: all 0.3s ease;
}

.hover-glow-row:hover {
    background: rgba(255, 255, 255, 0.03) !important;
    transform: translateX(5px);
}

.btn-view-details {
    transition: all 0.3s ease;
    white-space: nowrap;
}

.btn-view-details:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 0, 127, 0.4);
}
</style>
{% endblock %}

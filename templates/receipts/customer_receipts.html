{% extends "base.html" %}

{% block title %}{{ t('__customer_receipts') }}{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="galaxy-heading mb-4">
        <i class="bi bi-person-circle"></i> {{ customer.name }} - 收据管理
    </h1>
    
    {% if receipts_by_card %}
    {% for card_key, receipts in receipts_by_card.items() %}
    <div class="glass-panel p-4 mb-4">
        <h3 class="text-silver mb-3">
            <i class="bi bi-credit-card"></i> 信用卡: ****{{ card_key }}
        </h3>
        
        <div class="row">
            {% for receipt in receipts %}
            <div class="col-md-3 mb-3">
                <div class="card bg-dark text-white h-100">
                    <img src="{{ url_for('static', filename='uploads/' + receipt.file_path) }}" 
                         class="card-img-top" alt="{{ t('auto_text_1061') }}">
                    <div class="card-body">
                        <p class="card-text small">
                            <strong>{{ t('auto_text_1056') }}</strong> {{ receipt.transaction_date }}<br>
                            <strong>{{ t('auto_text_1057') }}</strong> RM {{ "%.2f"|format(receipt.amount or 0) }}<br>
                            {% if receipt.merchant_name %}
                            <strong>{{ t('auto_text_1058') }}</strong> {{ receipt.merchant_name }}
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="glass-panel p-5 text-center">
        <i class="bi bi-inbox" style="font-size: 4rem;"></i>
        <h3 class="mt-3 text-silver">{{ t('auto_text_1059') }}</h3>
        <p class="text-muted">{{ t('auto_text_1060') }}</p>
    </div>
    {% endif %}
    
    <a href="{{ url_for('receipts_home') }}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> 返回
    </a>
</div>
{% endblock %}
